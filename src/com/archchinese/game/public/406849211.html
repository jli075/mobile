var zb=function(){var f;var g;var h={};h.runTimeCanvasWidth=function(){return f.sys.canvas.Width};h.runTimeCanvasHeight=function(){return f.sys.canvas.height};h.setMainGameScene=function(a){f=a};h.setGameOverScene=function(a){g=a};h.setGameVocabLists=function(a,b,c,d,e){f.setGameVocabLists(a,b,c,d,e)};h.setGameLeaderboard=function(a){g.setGameLeaderboard(a)};return h}();var Ab=function(){var m='0',n='1',i='gameGlass',g='gameHelp',h='gameOptions',d='gameOver',f='gameScene1',e='gameTitle',o='wordStrike_controlOn',l='wordStrike_musicOn',p='wordstrike';var c={};c.getGameOverId=function(){return d};c.getGameTitleId=function(){return e};c.getGameSceneOneId=function(){return f};c.getGameHelpId=function(){return g};c.getGameOptionsId=function(){return h};c.getGameGlassId=function(){return i};c.isMusicOn=function(){return fn_getLocal(l)!=m};c.setMusicOn=function(a){var b=a?n:m;fn_saveLocal(l,b)};c.isMobileControlOn=function(){return fn_getLocal(o)==n};c.setMobileControlOn=function(a){var b=a?n:m;fn_saveLocal(o,b)};c.getAsset=function(a){return fn_getAsset(p,a)};c.gameSettings={playerSpeed:600,powerUpVel:40};return c}();Ab.gameTitle=function(){var n='Help',m='Options',l='Start',g='background.jpg',h='button-bg.png',i='pointerup';var c=fn_createScene(Ab.getGameTitleId());function d(){c.scene.start(Ab.getGameGlassId());c.scene.sleep(Ab.getGameGlassId());c.scene.start(Ab.getGameSceneOneId());c.scene.moveAbove(Ab.getGameTitleId(),Ab.getGameSceneOneId());c.scene.moveAbove(Ab.getGameGlassId(),Ab.getGameSceneOneId())}
function e(){c.scene.start(Ab.getGameOptionsId());c.scene.stop(Ab.getGameTitleId())}
function f(){c.scene.start(Ab.getGameHelpId());c.scene.stop(Ab.getGameTitleId())}
c.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId()};c.preload=function(){var a=Ab.getAsset(g);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b)}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,Ab.getAsset(h))};c.create=function(){Ab.gameMaster.styleCanvas();this.background=fn_createTileSprite(this,this.backgroundImgId);this.background.scale=2;this.background.alpha=0.1;this.startBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.15).setInteractive({useHandCursor:true}).on(i,d);fn_centerObject(this,this.startBtnBg,1.5);fn_nestedInCenter(fn_createTitlePageBtn(this,l,d),this.startBtnBg);this.optionsBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.15).setInteractive({useHandCursor:true}).on(i,e);fn_centerObject(this,this.optionsBtnBg,0);fn_nestedInCenter(fn_createTitlePageBtn(this,m,e),this.optionsBtnBg);this.helpBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.15).setInteractive({useHandCursor:true}).on(i,f);fn_centerObject(this,this.helpBtnBg,-1.5);fn_nestedInCenter(fn_createTitlePageBtn(this,n,f),this.helpBtnBg);fn_initPinyinFont(this)};c.update=function(){};return c}();Ab.gameHelp=function(){var i='#000000',n='Return',h='Use the arrow keys to move in the respective directions and dodge the enemy spaceships. If you collide with an enemy spaceship, you will lose one of your five lives, but you can always earn them back by collecting the floating power ups. Press SPACE to shoot down the matching spaceship. For each correct match, you gain 15 points. Remember to control your shooting, as your final score is calculated by both accuracy and your in-game score. Test your knowledge and reaction speed by earning the highest final score!',e='background.jpg',f='button-bg.png',l='center',g='frame.png',m='pointerup';function c(){d.scene.stop(Ab.getGameHelpId());d.scene.start(Ab.getGameTitleId())}
var d=fn_createScene(Ab.getGameHelpId());d.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId();this.frameImgId=fn_createId()};d.preload=function(){var a=Ab.getAsset(e);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b)}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,Ab.getAsset(f));this.load.image(this.frameImgId,Ab.getAsset(g))};d.create=function(){Ab.gameMaster.styleCanvas();this.background=fn_createTileSprite(this,this.backgroundImgId);this.background.scale=2;this.background.alpha=0.1;this.helpTextBg=this.add.sprite(100,200,this.frameImgId).setScale(1.25);fn_centerObject(this,this.helpTextBg,1.5);var a=h;this.helpText=this.add.text(400,100,a,{fontFamily:fn_getEnglishFont(),fontSize:36,color:i,align:l,wordWrap:{width:700,useAdvancedWrap:true}});fn_nestedInCenter(this.helpText,this.helpTextBg);this.returnBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.25).setInteractive({useHandCursor:true}).on(m,c);fn_centerObject(this,this.returnBtnBg,-4);fn_nestedInCenter(fn_createTitlePageBtn(this,n,c),this.returnBtnBg)};d.update=function(){};return d}();Ab.gameOptions=function(){var o='#000000',l='Enable joystick for mobile devices',i='Enable sound',n='Return',e='background.jpg',f='button-bg.png',g='checkedCheckbox.png',p='left',m='pointerup',h='uncheckedCheckbox.png';function c(){d.scene.stop(Ab.getGameOptionsId());d.scene.start(Ab.getGameTitleId())}
var d=fn_createScene(Ab.getGameOptionsId());d.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId();this.checkedCheckboxId=fn_createId();this.uncheckedCheckboxId=fn_createId();this.musicOn=Ab.isMusicOn();this.controlOn=Ab.isMobileControlOn()};d.preload=function(){var a=Ab.getAsset(e);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b)}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,Ab.getAsset(f));this.load.image(this.checkedCheckboxId,Ab.getAsset(g));this.load.image(this.uncheckedCheckboxId,Ab.getAsset(h))};d.create=function(){Ab.gameMaster.styleCanvas();this.background=fn_createTileSprite(this,this.backgroundImgId);this.background.scale=2;this.background.alpha=0.1;this.musicButton=this.add.image(0,0,this.checkedCheckboxId);this.musicButtonText=this.createLabel(i);fn_centerObject(this,this.musicButton,0.5);this.musicButton.x=this.musicButton.x-(this.musicButton.getBounds().width+this.musicButtonText.getBounds().width)/2;this.musicButtonText.y=this.musicButton.y-this.musicButton.getBounds().height/2;this.musicButtonText.x=this.musicButton.x+this.musicButton.getBounds().width+3;this.controlButton=this.add.image(0,0,this.checkedCheckboxId);this.controlButtonText=this.createLabel(l);fn_centerObject(this,this.controlButton,-0.5);this.controlButton.x=this.musicButton.x;this.controlButtonText.y=this.controlButton.y-this.controlButton.getBounds().height/2;this.controlButtonText.x=this.controlButton.x+this.controlButton.getBounds().width+3;this.musicButton.setInteractive({useHandCursor:true}).on(m,function(){this.musicOn=!this.musicOn;this.updateOptions()},this);this.controlButton.setInteractive({useHandCursor:true}).on(m,function(){this.controlOn=!this.controlOn;this.updateOptions()},this);this.updateOptions();this.returnBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.15).setInteractive({useHandCursor:true}).on(m,c);fn_centerObject(this,this.returnBtnBg,-4);fn_nestedInCenter(fn_createTitlePageBtn(this,n,c),this.returnBtnBg)};d.createLabel=function(a){return this.add.text(0,0,a,{fontFamily:fn_getEnglishFont(),fontSize:32,color:o,align:p})}.bind(d);d.updateOptions=function(){if(this.musicOn){this.musicButton.setTexture(this.checkedCheckboxId)}else{this.musicButton.setTexture(this.uncheckedCheckboxId)}Ab.setMusicOn(this.musicOn);this.musicButton.scale=1.8;if(this.controlOn){this.controlButton.setTexture(this.checkedCheckboxId)}else{this.controlButton.setTexture(this.uncheckedCheckboxId)}Ab.setMobileControlOn(this.controlOn);this.controlButton.scale=1.8}.bind(d);d.update=function(){};return d}();Ab.gameGlass=function(){var d='Resume',e='Stop',b='button-bg.png',c='pointerup';var a=fn_createScene(Ab.getGameGlassId());a.init=function(){this.btnBackgroundImgId=fn_createId()};a.preload=function(){this.load.image(this.btnBackgroundImgId,Ab.getAsset(b))};a.create=function(){this.resumeBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(c,this.resumeGame);this.resumeBtnBg.alpha=0.5;fn_centerObject(this,this.resumeBtnBg,-5);this.resumeBtnBg.x=this.sys.canvas.width-2*this.resumeBtnBg.getBounds().width-20+70;this.resumeBtn=fn_createBtn(this,d,24,this.resumeGame);this.resumeBtn.alpha=0.7;fn_nestedInCenter(this.resumeBtn,this.resumeBtnBg);this.stopBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(c,this.stopGame);this.stopBtnBg.alpha=0.5;fn_centerObject(this,this.stopBtnBg,-5);this.stopBtnBg.x=this.sys.canvas.width-this.stopBtnBg.getBounds().width-10+70;this.stopBtn=fn_createBtn(this,e,24,this.stopGame);this.stopBtn.alpha=0.7;fn_nestedInCenter(this.stopBtn,this.stopBtnBg)};a.resumeGame=function(){a.scene.sleep(Ab.getGameGlassId());a.scene.resume(Ab.getGameSceneOneId());a.scene.get(Ab.getGameSceneOneId()).enablePauseBtn();a.scene.get(Ab.getGameSceneOneId()).resetCursors()}.bind(a);a.stopGame=function(){a.scene.stop(Ab.getGameSceneOneId());a.scene.stop(Ab.getGameGlassId());a.scene.start(Ab.getGameOverId())}.bind(a);a.update=function(){};return a}();Ab.gameScene1=function(){var ob='',fb=' ',yb='%',xb='Accuracy: ',nb='Accuracy: 0%',qb='Created By: ',rb='Pause',lb='Power1',vb='SCREEN',wb='Score: ',mb='Score: 0',sb='Stop',ub='Word Count: ',pb='Word Count: 0',P='background.jpg',bb='beam.mp3',ab='beam.png',gb='bold',Q='button-bg.png',cb='explosion.mp3',Z='explosion.png',R='fire.png',V='green.png',U='heart.png',S='joystick.png',T='joystickthumb.png',db='pickup.mp3',_='player.png',kb='pointerdown',jb='pointerout',ib='pointerover',hb='pointerup',$='power-up.png',eb='sci-fi_platformer12.mp3',W='ship.png',X='ship2.png',Y='ship3.png',tb='~';var O=fn_createScene(Ab.getGameSceneOneId());O.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId();this.matchedCount=0;this.liveWords=[];this.life=[];this.baseSpeed=10;this.finalScore=0;this.score=0;this.totalShots=0;this.accuracy=0;this.heartId=fn_createId();this.shipId=fn_createId();this.ship2Id=fn_createId();this.ship3Id=fn_createId();this.explosionId=fn_createId();this.powerUpId=fn_createId();this.playerId=fn_createId();this.beamId=fn_createId();this.beamAudioId=fn_createId();this.explosionAudioId=fn_createId();this.pickupAudioId=fn_createId();this.musicId=fn_createId();this.aniShipId=fn_createId();this.aniShip2Id=fn_createId();this.aniShip3Id=fn_createId();this.aniExplosionId=fn_createId();this.anipowerUpRedId=fn_createId();this.anipowerUpGrayId=fn_createId();this.aniPlayerId=fn_createId();this.aniBeamId=fn_createId();this.isMobile=fn_isMobile()||Ab.isMobileControlOn();this.isMusicOn=Ab.isMusicOn();if(this.isMobile){this.mobileShootImgId=fn_createId();this.joyStickBaseImgId=fn_createId();this.joyStickThumbImgId=fn_createId()}this.sparkGId=fn_createId();this.currentMatchType=-1};O.getAsset=function(a){return Ab.getAsset(a)};O.loadSprite=function(a,b,c,d){this.load.spritesheet(a,this.getAsset(b),{frameWidth:c,frameHeight:d})}.bind(O);O.loadMusic=function(a,b){if(this.isMusicOn){this.load.audio(a,[this.getAsset(b)])}}.bind(O);O.preload=function(){if(this.isMobile){fn_loadJoyStick(this)}var a=this.getAsset(P);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b)}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,Ab.getAsset(Q));if(this.isMobile){this.load.image(this.mobileShootImgId,Ab.getAsset(R));this.load.image(this.joyStickBaseImgId,Ab.getAsset(S));this.load.image(this.joyStickThumbImgId,Ab.getAsset(T))}var c=[this.heartId,this.sparkGId];var d=[U,V];for(var e=0;e<d.length;e++){this.load.image(c[e],this.getAsset(d[e]))}this.loadSprite(this.shipId,W,16,16);this.loadSprite(this.ship2Id,X,32,16);this.loadSprite(this.ship3Id,Y,32,32);this.loadSprite(this.explosionId,Z,16,16);this.loadSprite(this.powerUpId,$,16,16);this.loadSprite(this.playerId,_,16,24);this.loadSprite(this.beamId,ab,16,16);if(this.isMusicOn){this.loadMusic(this.beamAudioId,bb);this.loadMusic(this.explosionAudioId,cb);this.loadMusic(this.pickupAudioId,db);this.loadMusic(this.musicId,eb)}};O.create=function(){if(this.isMobile){fn_createJoyStick(this,this.joyStickBaseImgId,this.joyStickThumbImgId)}fn_setToFullScreen(this);this.background=fn_createTileSprite(this,this.backgroundImgId);this.background.scale=2;this.background.alpha=0.1;var c=[this.aniShipId,this.aniShip2Id,this.aniShip3Id,this.aniPlayerId,this.aniBeamId,this.anipowerUpRedId,this.anipowerUpGrayId];var d=[this.shipId,this.ship2Id,this.ship3Id,this.playerId,this.beamId,this.powerUpId,this.powerUpId];for(var e=0;e<c.length;e++){if(c[e]===this.anipowerUpGrayId){fn_createRepeatAni(this,c[e],d[e],2,3)}else{fn_createRepeatAni(this,c[e],d[e],0,1)}}fn_createNonRepeatAni(this,this.aniExplosionId,this.explosionId);if(this.isMusicOn){this.music=fn_setUpAndPlayMusic(this,this.musicId)}this.setUpGameStatusLabels();this.nextWord=this.add.text(0,0,fb,{fontFamily:fn_getChineseFont(),fontWeight:gb,fontSize:48*1.2,color:fn_getGameVisitedTextColor()});this.nextWord.setInteractive({useHandCursor:true}).on(hb,function(){var a=this.liveWords[this.toMatchIndex].chinese;var b=this.liveWords[this.toMatchIndex].pinyin;fn_playWordSound(a,b)},this).on(ib,function(){this.nextWord.setStyle({fill:fn_getGameTextColor()})},this).on(jb,function(){this.nextWord.setStyle({fill:fn_getGameVisitedTextColor()})},this);this.setUpPowerUps();this.setUpPlayer();this.spacebar=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);this.projectiles=this.add.group();this.physics.add.collider(this.projectiles,this.powerUps,function(a,b){a.destroy();O.showScore()});this.physics.add.overlap(this.player,this.powerUps,this.pickPowerUp,null,this);if(this.isMusicOn){this.beamSound=this.sound.add(this.beamAudioId);this.explosionSound=this.sound.add(this.explosionAudioId);this.pickupSound=this.sound.add(this.pickupAudioId)}if(this.isMobile){var f=this.add.image(fn_getCanvasWidth()-180,fn_getCanvasHeight()-200,this.mobileShootImgId);f.setInteractive({useHandCursor:true}).on(kb,function(){if(this.player.active){this.shootBeam();this.totalShots+=1}},this);f.scaleX=0.8;f.scaleY=0.8}fn_loadGameVocabListsByUUID()};O.setUpPlayer=function(){this.player=this.physics.add.sprite(fn_getCanvasWidth()/2,fn_getCanvasHeight()-64,this.playerId);this.player.scale=2;this.player.play(this.aniPlayerId);this.cursorKeys=this.input.keyboard.createCursorKeys();this.player.setCollideWorldBounds(true);this.player.alpha=0.5;this.tweens.add({targets:this.player,y:fn_getCanvasHeight()-50,ease:lb,duration:2000,repeat:0,onComplete:function(){this.player.alpha=1},callbackScope:this})}.bind(O);O.setUpPowerUps=function(){this.powerUps=this.physics.add.group();this.time.addEvent({delay:5000,callback:function(){if(this.powerUps.getLength()+this.life.length<5){var a=this.physics.add.sprite(16,16,this.powerUpId);a.scale=2;this.powerUps.add(a);a.setRandomPosition(0,0,fn_getCanvasWidth(),fn_getCanvasHeight());if(Math.random()>0.5){a.play(this.anipowerUpRedId)}else{a.play(this.anipowerUpGrayId)}a.setVelocity(Ab.gameSettings.powerUpVel,Ab.gameSettings.powerUpVel);a.setCollideWorldBounds(true);a.setBounce(1)}},callbackScope:this,loop:true})}.bind(O);O.setUpGameStatusLabels=function(){for(var a=0;a<5;a++){var b=this.add.image(16+32*a,16,this.heartId);b.scale=2;b.setOrigin(0,0);this.life.push(b)}this.scoreText=fn_createStatusLabel(this,16,56,mb);this.accuracyText=fn_createStatusLabel(this,16,96,nb);this.titleText=fn_createStatusLabel(this,this.sys.canvas.width,16,ob);this.wordCountText=fn_createStatusLabel(this,this.sys.canvas.width,56,pb);this.creatorText=fn_createStatusLabel(this,this.sys.canvas.width,96,qb);this.pauseBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(hb,this.pauseGame);this.pauseBtnBg.alpha=0.5;fn_centerObject(this,this.pauseBtnBg,-5);this.pauseBtnBg.x=this.sys.canvas.width-2*this.pauseBtnBg.getBounds().width-20+70;this.pauseBtn=fn_createBtn(this,rb,24,this.pauseGame);this.pauseBtn.alpha=0.7;fn_nestedInCenter(this.pauseBtn,this.pauseBtnBg);this.stopBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(hb,this.navigateToGameOverScene);this.stopBtnBg.alpha=0.5;fn_centerObject(this,this.stopBtnBg,-5);this.stopBtnBg.x=this.sys.canvas.width-this.stopBtnBg.getBounds().width-10+70;this.stopBtn=fn_createBtn(this,sb,24,this.navigateToGameOverScene);this.stopBtn.alpha=0.7;fn_nestedInCenter(this.stopBtn,this.stopBtnBg)}.bind(O);O.pauseGame=function(){O.scene.pause(Ab.getGameSceneOneId());if(this.isMusicOn){O.music.pause()}O.scene.wake(Ab.getGameGlassId());O.scene.moveAbove(Ab.getGameSceneOneId(),Ab.getGameGlassId())}.bind(O);O.enablePauseBtn=function(){O.pauseBtn.setText(rb);fn_nestedInCenter(O.pauseBtn,O.pauseBtnBg);if(this.isMusicOn){O.music.resume()}};O.setGameVocabLists=function(a,b,c,d,e){this.chineseArray=b.split(tb);this.pinyinArray=c.split(tb);this.englishArray=d.split(tb);this.imgURLArray=e.split(tb);this.lastDataIndex=-1;this.updateListName(a);this.wordCountText.setText(ub+this.chineseArray.length);this.wordCountText.x=this.sys.canvas.width-this.wordCountText.getBounds().width-20;this.refreshWordPairs()}.bind(O);O.refreshWordPairs=function(){if(this.lastDataIndex<0){var a=parseInt(fn_getDifficultyLevel());switch(a){case 0:this.baseSpeed+=5;break;case 1:this.baseSpeed+=10;break;case 2:this.baseSpeed+=20;break;}}this.frontList=[];this.backList=[];this.liveWords=[];var b=fn_generateShuffledIndexes(ob+this.chineseArray.length).split(tb);var c=this.chineseArray;var d=this.pinyinArray;var e=this.englishArray;var f=this.imgURLArray;this.chineseArray=[];this.pinyinArray=[];this.englishArray=[];this.imgURLArray=[];for(var g=0;g<b.length;g++){var h=parseInt(b[g]);this.chineseArray.push(c[h]);this.pinyinArray.push(d[h]);this.englishArray.push(e[h]);this.imgURLArray.push(f[h])}var i=fn_getGameMatchType();if(i==this.currentMatchType){i=fn_getGameMatchType()}this.currentMatchType=i;var l=fn_getBatchSize();if(this.chineseArray.length<l){l=this.chineseArray.length}var m=[];var n=[];var o=[];for(k=0;k<l;k++){this.lastDataIndex+=1;if(this.lastDataIndex<this.chineseArray.length){m.push(this.chineseArray[this.lastDataIndex]);n.push(this.pinyinArray[this.lastDataIndex]);o.push(this.englishArray[this.lastDataIndex])}}switch(this.currentMatchType){case 0:fn_copyList(this.frontList,m);fn_copyList(this.backList,n);break;case 1:fn_copyList(this.frontList,n);fn_copyList(this.backList,m);break;case 2:fn_copyList(this.frontList,m);fn_copyList(this.backList,o);break;case 3:fn_copyList(this.frontList,o);fn_copyList(this.backList,m);break;case 4:fn_copyList(this.frontList,n);fn_copyList(this.backList,o);break;case 5:fn_copyList(this.frontList,o);fn_copyList(this.backList,n);break;}var p=fn_getCanvasWidth();var q=fn_getCanvasHeight();var r=fn_getPinyinFont();var s=fn_getChineseFont();var t=fn_getEnglishFont();var u=this.frontList.length;var v=parseInt(fn_getGameTextSize());if(v<38){v=38}for(var w=0;w<this.frontList.length;w++){var x=this.frontList[w];var y=v;var z=s;switch(this.currentMatchType){case 0:case 2:z=s;y=v+5;break;case 1:case 4:z=r;var A=fn_processPinyin(x);x=A;break;case 3:case 5:z=t;y=v*0.75;break;}var B=O.add.text(0,0,x,{fontFamily:z,fontWeight:gb,fontSize:y,color:fn_getGameTextColor()}).setOrigin(0.5);var C=O.add.container(10,100,[B]);C.setSize(B.getBounds().width,B.getBounds().height);O.physics.world.enableBody(C);var D=Math.floor(Math.random()*3);var E=this.ship3Id;var F=this.aniShip3Id;var G=0;switch(D){case 0:E=this.shipId;F=this.aniShipId;G=10;break;case 1:E=this.ship2Id;F=this.aniShip2Id;G=8;break;case 2:E=this.ship3Id;F=this.aniShip3Id;G=-2;break;}var H=this.add.sprite(0,fn_getCanvasHeight(),E);H.scale=2;H.play(F);C.add(H);C.getAt(1).y=-C.getAt(0).getBounds().height+G;var I=C.getAt(0).getBounds().width;var J=p-I<=0?I:p-50;C.x=Phaser.Math.Between(I,J);C.y=Phaser.Math.Between(10,20);C.speed=this.baseSpeed+(1+D)*25;C.body.setVelocity(Phaser.Math.Between(-200,200),Phaser.Math.Between(10,50));C.body.allowGravity=false;C.body.setBounce(1);C.body.setCollideWorldBounds(true);var K=this.backList[w];C.answer=K;var L=s;var M=v;switch(this.currentMatchType){case 0:case 5:L=r;K=fn_processPinyin(K);break;case 2:case 4:L=t;M=v*0.75;break;case 1:case 3:L=s;M=v+5;break;}var N=O.add.text(0,0,K,{fontFamily:L,fontWeight:gb,fontSize:M,color:fn_getGameTextColor()}).setOrigin(0.5);N.setVisible(false);C.backText=N;C.chinese=m[w];C.pinyin=n[w];this.liveWords.push(C)}this.physics.add.collider(this.liveWords,this.liveWords);this.physics.add.overlap(this.player,this.liveWords,this.hurtPlayer,null,this);this.physics.add.overlap(this.projectiles,this.liveWords,this.hitEnemy,null,this);this.showPromptText()}.bind(O);O.showPromptText=function(){if(this.liveWords.length>0){this.toMatchIndex=Math.floor(Math.random()*this.liveWords.length);var a=this.liveWords[this.toMatchIndex].backText;var b=this.liveWords[this.toMatchIndex].chinese;var c=this.liveWords[this.toMatchIndex].pinyin;if(b.length<5){if(this.isMusicOn){if(fn_getGameWordAudio()){this.music.pause();fn_playWordSound(b,c);this.time.delayedCall(b.length*1000,function(){this.music.resume()},[],this)}}}this.nextWord.setText(a.text);this.nextWord.setFontFamily(a.style.fontFamily)}else{this.nextWord.setText(ob)}fn_centerText(this.nextWord);this.nextWord.y=this.nextWord.getBounds().height/2}.bind(O);O.updateListName=function(a){this.titleText.setText(a);this.titleText.x=this.sys.canvas.width-this.titleText.getBounds().width-16;this.creatorText.setText(qb+fn_getCreator());this.creatorText.x=this.sys.canvas.width-this.creatorText.getBounds().width-16}.bind(O);O.emitSparkles=function(a,b,c){var d=this.add.particles(a).createEmitter({speed:{min:-800,max:800},angle:{min:0,max:360},scale:{start:0.5,end:0},blendMode:vb,lifespan:600,gravityY:800});d.setPosition(b,c);for(var e=0;e<25;e++){d.explode()}};O.pickPowerUp=function(a,b){var c=this.life.length;if(c<5){var d=this.add.image(16+32*c,16,this.heartId);d.scale=2;d.setOrigin(0,0);this.life.push(d)}this.emitSparkles(this.sparkGId,b.x,b.y);this.powerUps.remove(b);b.destroy();if(this.isMusicOn){this.pickupSound.play()}}.bind(O);O.handleWordMatch=function(a){a.removeAt(1,true);a.backText.setVisible(true);a.add(a.backText);this.nextWord.setText(ob);a.getAt(0).setColor(fn_getGameMatchedTextColor());a.getAt(0).setOrigin(0.5);if(fn_hasChineseText(a.getAt(0).text)){a.getAt(0).setFontSize(48*2)}else{a.getAt(0).setFontSize(32*2)}a.getAt(1).setOrigin(0.5);a.getAt(1).setColor(fn_getGameMatchedTextColor());if(fn_hasChineseText(a.getAt(1).text)){a.getAt(1).setFontSize(48*2)}else{a.getAt(1).setFontSize(32*2)}a.getAt(1).y=a.getAt(0).getBounds().height+10;a.body.setGravityY(10);a.body.allowGravity=true;this.tweens.add({targets:a,angle:Phaser.Math.Between(-120,120),duration:3000,yoyo:true,repeat:-1});var b=this.liveWords.indexOf(a);if(b>=0){this.liveWords.splice(b,1)}this.time.delayedCall(2000,this.removeMatchedWord,[a],this);var c=fn_getGameTextColor();for(j=0;j<this.liveWords.length;j++){this.liveWords[j].first.setColor(c)}if(this.isMusicOn){this.pickupSound.play()}}.bind(O);O.removeMatchedWord=function(a){a.removeAll(true);a.destroy();if(this.liveWords.length===0){if(this.lastDataIndex<this.chineseArray.length-1){}else{this.lastDataIndex=-1}this.refreshWordPairs()}else{this.showPromptText()}}.bind(O);O.showScore=function(){if(this.totalShots==0){this.accuracyText.setText(nb);this.accuracy=0}else{this.accuracy=Math.floor(100*this.matchedCount/this.totalShots)}if(this.score<0){this.score=0}this.scoreText.setText(wb+this.score);this.accuracyText.setText(xb+this.accuracy+yb)}.bind(O);O.hurtPlayer=function(a,b){if(this.player.alpha<1){return}if(this.isMusicOn){var c={mute:false,volume:0.5,rate:1,detune:0,seek:0,loop:false,delay:0};this.explosionSound.play(c)}if(this.nextWord.text!=b.backText.text){this.score-=1}else{this.score+=15;this.handleWordMatch(b)}this.showScore();if(this.life.length>0){var d=this.life.pop();d.destroy();if(this.life.length==0){this.time.delayedCall(1000,this.navigateToGameOverScene,[],this)}}var e=this.physics.add.sprite(a.x,a.y,this.explosionId);e.scale=4;e.play(this.aniExplosionId);a.disableBody(true,true);this.time.addEvent({delay:1000,callback:this.resetPlayer,callbackScope:this,loop:false})}.bind(O);O.resetPlayer=function(){var a=fn_getCanvasWidth()/2;var b=fn_getCanvasHeight()+64;this.player.enableBody(true,a,b,true,true);this.player.alpha=0.5;this.tweens.add({targets:this.player,y:fn_getCanvasHeight()-50,ease:lb,duration:1000,repeat:0,onComplete:function(){this.player.alpha=1},callbackScope:this})}.bind(O);O.hitEnemy=function(a,b){var c=this.physics.add.sprite(b.x,b.y-b.displayHeight/4,this.explosionId);c.scale=4;c.play(this.aniExplosionId);if(this.isMusicOn){var d={mute:false,volume:0.5,rate:1,detune:0,seek:0,loop:false,delay:0};this.explosionSound.play(d)}this.projectiles.remove(a);a.destroy();if(this.nextWord.text.length>0){if(this.nextWord.text!=b.backText.text){this.score-=1;b.first.setColor(fn_getGameVisitedTextColor());this.time.delayedCall(1000,function(){b.first.setColor(fn_getGameTextColor())},[],this);this.showScore()}else{this.matchedCount+=1;this.score+=15;this.handleWordMatch(b);var e=fn_getGameTextColor();for(j=0;j<this.liveWords.length;j++){this.liveWords[j].first.setColor(e)}this.showScore()}}}.bind(O);O.navigateToGameOverScene=function(){this.finalScore=Math.ceil(this.score*0.8+this.score*0.2*this.accuracy/100);O.scene.stop(Ab.getGameSceneOneId());O.scene.stop(Ab.getGameGlassId());O.scene.start(Ab.getGameOverId())}.bind(O);O.createBeam=function(a,b){var c=this.physics.add.sprite(this.player.x,this.player.y-16,this.beamId);c.scale=2;c.play(this.aniBeamId);this.physics.world.enableBody(c);c.body.velocity.x=a;c.body.velocity.y=b;this.projectiles.add(c)}.bind(O);O.shootBeam=function(){this.createBeam(0,-450);if(this.isMusicOn){this.beamSound.play()}}.bind(O);O.resetCursors=function(){this.cursorKeys.left.isDown=false;this.cursorKeys.right.isDown=false;this.cursorKeys.up.isDown=false;this.cursorKeys.down.isDown=false;if(this.isMobile){this.joystick.left=false;this.joystick.right=false;this.joystick.up=false;this.joystick.down=false}}.bind(O);O.movePlayerManager=function(){this.player.setVelocity(0);var a=this.cursorKeys.left.isDown;var b=this.cursorKeys.right.isDown;var c=this.cursorKeys.up.isDown;var d=this.cursorKeys.down.isDown;if(this.isMobile){a=a||this.joystick.left;b=b||this.joystick.right;c=c||this.joystick.up;d=d||this.joystick.down}if(a){this.player.setVelocityX(-Ab.gameSettings.playerSpeed)}else if(b){this.player.setVelocityX(Ab.gameSettings.playerSpeed)}if(c){this.player.setVelocityY(-Ab.gameSettings.playerSpeed)}else if(d){this.player.setVelocityY(Ab.gameSettings.playerSpeed)}}.bind(O);O.resetShipPos=function(a){a.y=0;a.x=Phaser.Math.Between(0+a.getBounds().width,fn_getCanvasWidth()-a.getBounds().width)}.bind(O);O.update=function(){var a=fn_getCanvasHeight();var b=fn_getCanvasWidth();var c=a*0.2;for(var d=0;d<this.liveWords.length;d++){var e=this.liveWords[d];if(e.y>c){e.body.setBounce(0);e.body.setCollideWorldBounds(false);e.body.setVelocity(Phaser.Math.Between(-20,20),e.speed)}if(e.y>a){e.y=0;var f=e.getAt(0).getBounds().width;var g=b-f;e.x=Phaser.Math.Between(f,g);if(e.x<0){e.x=b/2}e.body.setVelocity(Phaser.Math.Between(-200,200),Phaser.Math.Between(10,50));e.body.setBounce(1);e.body.setCollideWorldBounds(true)}}this.background.tilePositionY-=0.5;this.movePlayerManager();if(Phaser.Input.Keyboard.JustDown(this.spacebar)){if(this.player.active){this.shootBeam();this.totalShots+=1}}for(var d=0;d<this.projectiles.getChildren().length;d++){var h=this.projectiles.getChildren()[d];if(h.y<10){h.destroy();this.showScore()}}};return O}();Ab.gameOver=function(){var d='#000000',c='button-bg.png';var b=fn_createScene(Ab.getGameOverId());b.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId()};b.preload=function(){this.load.image(this.btnBackgroundImgId,Ab.getAsset(c))};b.create=function(){fn_stopFullScreen(this);fn_createGradient(this,this.backgroundImgId,d,d);fn_setBackground(this,this.backgroundImgId);fn_centerObject(this,fn_createGameOverLabel(this),3);fn_centerObject(this,fn_createFinalScoreLabel(this,Ab.gameScene1.finalScore),2);fn_createPlayAgainBtn(this,this.btnBackgroundImgId);if(fn_isInternetExplorer()){}else{fn_loadGameLeaderboard()}};b.update=function(){};b.setGameLeaderboard=function(a){fn_showLeaderboard(this,a,Ab.gameScene1.finalScore,document)}.bind(b);return b}();Ab.gameMaster=function(){function b(){var a=fn_getConfig();a.scene.push(Ab.gameTitle);a.scene.push(Ab.gameHelp);a.scene.push(Ab.gameOptions);a.scene.push(Ab.gameGlass);a.scene.push(Ab.gameScene1);a.scene.push(Ab.gameOver);a.physics.arcade.gravity.y=0;return a}
zb.setMainGameScene(Ab.gameScene1);zb.setGameOverScene(Ab.gameOver);var c={};c.game=fn_createGame(b());fn_registerDataAgent(zb);c.styleCanvas=function(){fn_styleCanvas(this.game)};return c}();