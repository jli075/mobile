var Q=function(){var f;var g;var h={};h.runTimeCanvasWidth=function(){return f.sys.canvas.Width};h.runTimeCanvasHeight=function(){return f.sys.canvas.height};h.setMainGameScene=function(a){f=a};h.setGameOverScene=function(a){g=a};h.setGameVocabLists=function(a,b,c,d,e){f.setGameVocabLists(a,b,c,d,e)};h.setGameLeaderboard=function(a){g.setGameLeaderboard(a)};return h}();var R=function(){var h='dragandmatch',g='gameGlass',f='gameHelp',c='gameOver',e='gameScene1',d='gameTitle';var b={};b.getGameOverId=function(){return c};b.getGameTitleId=function(){return d};b.getGameSceneOneId=function(){return e};b.getGameHelpId=function(){return f};b.getGameGlassId=function(){return g};b.getAsset=function(a){return fn_getAsset(h,a)};return b}();R.gameTitle=function(){var j='Help',i='Start',f='background.png',g='button-bg.png',h='pointerup';var c=fn_createScene(R.getGameTitleId());function d(){c.scene.start(R.getGameGlassId());c.scene.sleep(R.getGameGlassId());c.scene.start(R.getGameSceneOneId());c.scene.moveAbove(R.getGameTitleId(),R.getGameSceneOneId());c.scene.moveAbove(R.getGameGlassId(),R.getGameSceneOneId())}
function e(){c.scene.start(R.getGameHelpId());c.scene.stop(R.getGameTitleId())}
c.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId()};c.preload=function(){var a=R.getAsset(f);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b);this.userBackgroundImageUsed=true}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,R.getAsset(g))};c.create=function(){R.gameMaster.styleCanvas();if(this.userBackgroundImageUsed){fn_setBackground(this,this.backgroundImgId)}else{fn_createTileSprite(this,this.backgroundImgId)}this.startBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.25).setInteractive({useHandCursor:true}).on(h,d);fn_centerObject(this,this.startBtnBg,1);fn_nestedInCenter(fn_createTitlePageBtn(this,i,d),this.startBtnBg);this.helpBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.25).setInteractive({useHandCursor:true}).on(h,e);fn_centerObject(this,this.helpBtnBg,-1);fn_nestedInCenter(fn_createTitlePageBtn(this,j,e),this.helpBtnBg);fn_initPinyinFont(this)};c.update=function(){};return c}();R.gameHelp=function(){var i='#000000',m='Return',h='Welcome to Drag and Match!\n\nDrag the matching Chinese, Pinyin, or English onto each other to make them disappear. Good luck!',e='background.png',f='button-bg.png',j='center',g='frame.png',l='pointerup';function c(){d.scene.stop(R.getGameHelpId());d.scene.start(R.getGameTitleId())}
var d=fn_createScene(R.getGameHelpId());d.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId();this.frameImgId=fn_createId()};d.preload=function(){var a=R.getAsset(e);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b);this.userBackgroundImageUsed=true}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,R.getAsset(f));this.load.image(this.frameImgId,R.getAsset(g))};d.create=function(){R.gameMaster.styleCanvas();if(this.userBackgroundImageUsed){fn_setBackground(this,this.backgroundImgId)}else{fn_createTileSprite(this,this.backgroundImgId)}this.helpTextBg=this.add.sprite(100,200,this.frameImgId).setScale(1.25);fn_centerObject(this,this.helpTextBg,1.5);var a=h;this.helpText=this.add.text(400,100,a,{fontFamily:fn_getEnglishFont(),fontSize:36,color:i,align:j,wordWrap:{width:700,useAdvancedWrap:true}});fn_nestedInCenter(this.helpText,this.helpTextBg);this.returnBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.25).setInteractive({useHandCursor:true}).on(l,c);fn_centerObject(this,this.returnBtnBg,-4);fn_nestedInCenter(fn_createTitlePageBtn(this,m,c),this.returnBtnBg)};d.update=function(){};return d}();R.gameGlass=function(){var d='Resume',e='Stop',b='button-bg.png',c='pointerup';var a=fn_createScene(R.getGameGlassId());a.init=function(){this.btnBackgroundImgId=fn_createId()};a.preload=function(){this.load.image(this.btnBackgroundImgId,R.getAsset(b))};a.create=function(){this.resumeBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(c,this.resumeGame);this.resumeBtnBg.alpha=0.5;fn_centerObject(this,this.resumeBtnBg,-5);this.resumeBtnBg.x=this.sys.canvas.width-2*this.resumeBtnBg.getBounds().width-20+70;this.resumeBtn=fn_createBtn(this,d,24,this.resumeGame);this.resumeBtn.alpha=0.7;fn_nestedInCenter(this.resumeBtn,this.resumeBtnBg);this.stopBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(c,this.stopGame);this.stopBtnBg.alpha=0.5;fn_centerObject(this,this.stopBtnBg,-5);this.stopBtnBg.x=this.sys.canvas.width-this.stopBtnBg.getBounds().width-10+70;this.stopBtn=fn_createBtn(this,e,24,this.stopGame);this.stopBtn.alpha=0.7;fn_nestedInCenter(this.stopBtn,this.stopBtnBg)};a.resumeGame=function(){a.scene.sleep(R.getGameGlassId());a.scene.resume(R.getGameSceneOneId());a.scene.get(R.getGameSceneOneId()).enablePauseBtn()}.bind(a);a.stopGame=function(){a.scene.stop(R.getGameSceneOneId());a.scene.stop(R.getGameGlassId());a.scene.start(R.getGameOverId())}.bind(a);a.update=function(){};return a}();R.gameScene1=function(){var y='',J='#000000',P=':',A='Created By: ',C='Pause',D='Stop',O='Time: ',x='Time: 0',F='Word Count: ',z='Word Count: 0',t='background.png',G='bold',u='button-bg.png',v='checkmark.png',K='drag',L='dragend',I='dragstart',w='pickup.mp3',N='pointerout',M='pointerover',B='pointerup',H='rgba(0,0,0,0.5)',E='~';var s=fn_createScene(R.getGameSceneOneId());s.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId();this.pickupAudioId=fn_createId();this.checkMarkId=fn_createId();this.liveWords=[];this.pushAwaySpeed=200;this.batchIndex=0;this.matchedChineseList=[];this.totalChineseCount=0;this.totalTime=0;this.currentMatchType=-1};s.preload=function(){var a=R.getAsset(t);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b);this.userBackgroundImageUsed=true}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,this.getAsset(u));this.load.image(this.checkMarkId,this.getAsset(v));this.loadMusic(this.pickupAudioId,w)};s.create=function(){fn_setToFullScreen(this);if(this.userBackgroundImageUsed){fn_setBackground(this,this.backgroundImgId)}else{fn_createTileSprite(this,this.backgroundImgId)}this.pickupSound=this.sound.add(this.pickupAudioId);this.setUpGameStatusLabels();fn_loadGameVocabListsByUUID()};s.update=function(){};s.getAsset=function(a){return R.getAsset(a)};s.loadMusic=function(a,b){this.load.audio(a,[this.getAsset(b)])}.bind(s);s.setUpGameStatusLabels=function(){this.timerText=fn_createStatusLabel(this,16,16,x);fn_createProgressBar(this,16,56,160,30);fn_updateProgressBar(this,0);this.titleText=fn_createStatusLabel(this,this.sys.canvas.width,16,y);this.wordCountText=fn_createStatusLabel(this,this.sys.canvas.width,56,z);this.creatorText=fn_createStatusLabel(this,this.sys.canvas.width,96,A);this.pauseBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(B,this.pauseGame);this.pauseBtnBg.alpha=0.5;fn_centerObject(this,this.pauseBtnBg,-5);this.pauseBtnBg.x=this.sys.canvas.width-2*this.pauseBtnBg.getBounds().width-20+70;this.pauseBtn=fn_createBtn(this,C,24,this.pauseGame);this.pauseBtn.alpha=0.7;fn_nestedInCenter(this.pauseBtn,this.pauseBtnBg);this.stopBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(B,this.navigateToGameOverScene);this.stopBtnBg.alpha=0.5;fn_centerObject(this,this.stopBtnBg,-5);this.stopBtnBg.x=this.sys.canvas.width-this.stopBtnBg.getBounds().width-10+70;this.stopBtn=fn_createBtn(this,D,24,this.navigateToGameOverScene);this.stopBtn.alpha=0.7;fn_nestedInCenter(this.stopBtn,this.stopBtnBg)}.bind(s);s.pauseGame=function(){s.scene.pause(R.getGameSceneOneId());s.scene.wake(R.getGameGlassId());s.scene.moveAbove(R.getGameSceneOneId(),R.getGameGlassId())}.bind(s);s.enablePauseBtn=function(){s.pauseBtn.setText(C);fn_nestedInCenter(s.pauseBtn,s.pauseBtnBg)};s.setGameVocabLists=function(a,b,c,d,e){this.chineseArray=b.split(E);this.pinyinArray=c.split(E);this.englishArray=d.split(E);this.imgURLArray=e.split(E);this.lastDataIndex=-1;this.updateListName(a);this.totalChineseCount=this.chineseArray.length;this.wordCountText.setText(F+this.chineseArray.length);this.wordCountText.x=this.sys.canvas.width-this.wordCountText.getBounds().width-20;this.shuffleChinesePinyinEnglishImgArrays();this.refreshWithNewWords()}.bind(s);s.createWordContainer=function(a,b,c){var d=fn_getCanvasWidth();var e=fn_getCanvasHeight();var f=fn_getPinyinFont();var g=fn_getChineseFont();var h=fn_getEnglishFont();var i=parseInt(fn_getGameTextSize());if(i<42){i=42}var j=i;var l=g;switch(this.currentMatchType){case 0:case 2:l=g;j=i+8;break;case 1:case 4:l=f;var m=fn_processPinyin(a);a=m;j=i*0.95;break;case 3:case 5:l=h;j=i*0.85;break;}var n=s.add.text(0,0,a,{fontFamily:l,fontWeight:G,fontSize:j,color:fn_getGameTextColor()}).setOrigin(0.5);n.setShadow(1,1,H,2);var o=s.add.container(10,100,[n]);o.setSize(o.getAt(0).getBounds().width,o.getAt(0).getBounds().height);var p=g;var q=i;switch(this.currentMatchType){case 0:case 5:p=f;b=fn_processPinyin(b);q=i*0.95;break;case 2:case 4:p=h;q=i*0.85;break;case 1:case 3:p=g;q=i+8;break;}var r=s.add.text(0,0,b,{fontFamily:p,fontWeight:G,fontSize:q,color:fn_getGameTextColor()}).setOrigin(0.5);r.setVisible(false);r.setShadow(1,1,H,2);o.backText=r;switch(this.currentMatchType){case 0:o.chinese=a;o.pinyin=b;break;case 1:o.chinese=b;o.pinyin=a;break;case 2:o.chinese=a;o.pinyin=c;break;case 3:o.pinyin=c;o.chinese=b;break;case 4:o.pinyin=a;o.chinese=c;break;case 5:o.pinyin=b;o.chinese=c;break;}return o}.bind(s);s.setWordInteractive=function(d){d.setInteractive({useHandCursor:true,draggable:true}).on(I,function(a,b,c){d.getAt(0).setStyle({fill:J});this.children.bringToTop(d);if(!!!this.gameTimer){this.gameTimer=this.time.addEvent({delay:100,callback:this.updateTime,callbackScope:this,loop:true})}},this).on(K,function(a,b,c){d.setPosition(b,c)}).on(L,function(a,b,c){}).on(B,function(){var a=fn_findOverlap(this.liveWords,d);if(a!=null){this.checkCorrect(d,a)}},this).on(M,function(){d.getAt(0).setStyle({fill:fn_getGameVisitedTextColor()})},this).on(N,function(){d.getAt(0).setStyle({fill:fn_getGameTextColor()})},this)}.bind(s);s.shuffleChinesePinyinEnglishImgArrays=function(){var a=fn_syncShuffle([this.chineseArray,this.pinyinArray,this.englishArray,this.imgURLArray]);this.chineseArray=a[0];this.pinyinArray=a[1];this.englishArray=a[2];this.imgURLArray=a[3]}.bind(s);s.refreshWithNewWords=function(){if(this.gameTimer){this.gameTimer.paused=true}this.frontList=[];this.backList=[];this.helpList=[];this.liveWords=[];var a=fn_getGameMatchType();if(a==this.currentMatchType){a=fn_getGameMatchType()}this.currentMatchType=a;var b=fn_getBatchSize();if(this.chineseArray.length<b){b=this.chineseArray.length}var c=[];var d=[];var e=[];for(k=0;k<b;k++){this.lastDataIndex+=1;if(this.lastDataIndex<this.chineseArray.length){c.push(this.chineseArray[this.lastDataIndex]);d.push(this.pinyinArray[this.lastDataIndex]);e.push(this.englishArray[this.lastDataIndex])}}switch(this.currentMatchType){case 0:fn_copyList(this.frontList,c);fn_copyList(this.backList,d);fn_copyList(this.helpList,e);break;case 1:fn_copyList(this.frontList,d);fn_copyList(this.backList,c);fn_copyList(this.helpList,e);break;case 2:fn_copyList(this.frontList,c);fn_copyList(this.backList,e);fn_copyList(this.helpList,d);break;case 3:fn_copyList(this.frontList,e);fn_copyList(this.backList,c);fn_copyList(this.helpList,d);break;case 4:fn_copyList(this.frontList,d);fn_copyList(this.backList,e);fn_copyList(this.helpList,c);break;case 5:fn_copyList(this.frontList,e);fn_copyList(this.backList,d);fn_copyList(this.helpList,c);break;}for(var f=0;f<this.frontList.length;f++){var g=this.createWordContainer(this.frontList[f],this.backList[f],this.helpList[f]);this.setWordInteractive(g);this.liveWords.push(g);var h=this.createWordContainer(this.frontList[f],this.backList[f],this.helpList[f]);h.removeAll(true);var i=h.backText;h.backText=null;i.setVisible(true);h.add(i);h.setSize(h.getAt(0).getBounds().width,h.getAt(0).getBounds().height);this.setWordInteractive(h);this.liveWords.push(h)}this.batchIndex+=1;this.spreadWordsOnTheScreen()}.bind(s);s.spreadWordsOnTheScreen=function(){for(var a=0;a<this.liveWords.length;a++){var b=this.liveWords[a];this.physics.world.enableBody(b);b.setVisible(true);b.getAt(0).setVisible(true);b.x=Math.random()*fn_getCanvasWidth();b.y=Math.random()*fn_getCanvasHeight();b.body.setVelocity(fn_rand(-1*this.pushAwaySpeed,this.pushAwaySpeed),fn_rand(-1*this.pushAwaySpeed,this.pushAwaySpeed));b.body.allowGravity=false;b.body.setBounce(1);b.body.allowDrag=true;b.body.setDrag(40);b.body.setCollideWorldBounds(true)}this.physics.add.collider(this.liveWords,this.liveWords);this.physics.add.overlap(this.liveWords,this.liveWords,function(){},null,this);this.time.delayedCall(1000,this.settleDownWords,[],this)}.bind(s);s.checkCorrect=function(a,b){if(a.chinese==b.chinese){fn_playSound(this.pickupSound,fn_getBackgroundMusicVolume(),false);a.removeInteractive();b.removeInteractive();if(this.matchedChineseList.indexOf(a.chinese)<0){this.matchedChineseList.push(a.chinese)}var c=this.add.image(0,0,this.checkMarkId);c.scale=0.8;a.add(c);a.getAt(1).y=a.getAt(0).y-a.getAt(0).getBounds().height/2;a.getAt(1).x=a.getAt(0).x+a.getAt(0).getBounds().width;a.getAt(0).setColor(fn_getGameMatchedTextColor());a.getAt(0).setBackgroundColor(null);var d=s.add.text(0,0,b.getAt(0).text,{fontFamily:b.getAt(0).style.fontFamily,fontWeight:G,fontSize:b.getAt(0).style.fontSize,color:fn_getGameMatchedTextColor()}).setOrigin(0.5);a.add(d);a.getAt(2).y=a.getAt(0).y-a.getAt(0).getBounds().height;a.getAt(2).x=a.getAt(0).x;fn_fadeOut(this,3000,a);fn_removeElement(this.liveWords,a);fn_removeElement(this.liveWords,b);b.destroy();this.time.delayedCall(2000,function(){a.destroy()},[],this);this.updateProgress()}else{a.body.setBounce(1);b.body.setBounce(1);a.body.setVelocity(fn_rand(-1*this.pushAwaySpeed,this.pushAwaySpeed),fn_rand(-1*this.pushAwaySpeed,this.pushAwaySpeed));b.body.setVelocity(fn_rand(-1*this.pushAwaySpeed,this.pushAwaySpeed),fn_rand(-1*this.pushAwaySpeed,this.pushAwaySpeed))}};s.settleDownWords=function(){for(var a=0;a<this.liveWords.length;a++){var b=this.liveWords[a];b.body.setBounce(0)}if(this.gameTimer){this.gameTimer.paused=false}}.bind(s);s.updateTime=function(){this.totalTime+=1;this.timerText.setText(O+fn_formatSeconds(Math.floor(this.totalTime/10))+P+this.totalTime%10)}.bind(s);s.updateListName=function(a){this.titleText.setText(a);this.titleText.x=this.sys.canvas.width-this.titleText.getBounds().width-16;this.creatorText.setText(A+fn_getCreator());this.creatorText.x=this.sys.canvas.width-this.creatorText.getBounds().width-16}.bind(s);s.updateProgress=function(){if(this.totalChineseCount>0){var a=this.matchedChineseList.length/this.totalChineseCount;fn_updateProgressBar(this,a);this.checkIfDone()}}.bind(s);s.checkIfDone=function(){if(this.matchedChineseList.length==this.totalChineseCount){this.gameTimer.paused=true;this.time.delayedCall(1000,this.navigateToGameOverScene,[],this)}else{if(this.liveWords.length==0){if(this.lastDataIndex<this.chineseArray.length-1){this.refreshWithNewWords()}else{this.gameTimer.paused=true;this.time.delayedCall(1000,this.navigateToGameOverScene,[],this)}}}}.bind(s);s.navigateToGameOverScene=function(){if(this.totalChineseCount-this.matchedChineseList.length>1){this.totalTime=0}s.scene.stop(R.getGameSceneOneId());s.scene.stop(R.getGameGlassId());s.scene.start(R.getGameOverId())}.bind(s);return s}();R.gameOver=function(){var d='#000000',c='button-bg.png';var b=fn_createScene(R.getGameOverId());b.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId()};b.preload=function(){this.load.image(this.btnBackgroundImgId,R.getAsset(c))};b.create=function(){fn_stopFullScreen(this);fn_createGradient(this,this.backgroundImgId,d,d);fn_setBackground(this,this.backgroundImgId);fn_centerObject(this,fn_createGameOverLabel(this),3);var a=R.gameScene1.totalTime;if(a>0){this.finalTime=fn_formatMilliSeconds(R.gameScene1.totalTime);fn_centerObject(this,fn_createFinalTimeLabel(this,this.finalTime),2)}fn_createPlayAgainBtn(this,this.btnBackgroundImgId);if(fn_isInternetExplorer()){}else{fn_loadGameLeaderboard()}};b.update=function(){};b.setGameLeaderboard=function(a){fn_showTimeLeaderboard(this,a,R.gameScene1.totalTime,document)}.bind(b);return b}();R.gameMaster=function(){function b(){var a=fn_getConfig();a.scene.push(R.gameTitle);a.scene.push(R.gameHelp);a.scene.push(R.gameGlass);a.scene.push(R.gameScene1);a.scene.push(R.gameOver);a.physics.arcade.gravity.y=0;return a}
Q.setMainGameScene(R.gameScene1);Q.setGameOverScene(R.gameOver);var c={};c.game=fn_createGame(b());fn_registerDataAgent(Q);c.styleCanvas=function(){fn_styleCanvas(this.game)};return c}();