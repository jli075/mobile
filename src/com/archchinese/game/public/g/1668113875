var w=function(){var f;var g={};g.runTimeCanvasWidth=function(){return f.sys.canvas.Width};g.runTimeCanvasHeight=function(){return f.sys.canvas.height};g.setMainGameScene=function(a){f=a};g.setGameVocabLists=function(a,b,c,d,e){f.setGameVocabLists(a,b,c,d,e)};return g}();var x=function(){var e='gameHelp',b='gameOver',d='gameScene1',c='gameTitle';var a={};a.getGameOverId=function(){return b};a.getGameTitleId=function(){return c};a.getGameSceneOneId=function(){return d};a.getGameHelpId=function(){return e};return a}();var y=function(){var v='',o='#FF00FF',p='#FFFF00',u='Help',q='Start',n='assets/background.png',r='pointerdown',t='pointerout',s='pointerover';var b=true;var c=false;var d=new Phaser.Scene(x.getGameTitleId());d.init=function(){this.backgroundImgId=fn_createId()};d.preload=function(){this.load.image(this.backgroundImgId,fn_getAssetPath()+n)};function e(){var a=C.game.scene;console.log(b);if(b){a.start(x.getGameSceneOneId());a.moveAbove(x.getGameTitleId(),x.getGameSceneOneId());b=false}}
function f(){d.startBtn.setStyle({fill:o})}
function g(){d.startBtn.setStyle({fill:p})}
;function h(){d.helpBtn.setStyle({fill:o})}
function l(){d.helpBtn.setStyle({fill:p})}
;function m(){var a=C.game.scene;if(b){if(c==false){a.start(x.getGameHelpId());c=true}else if(c){a.bringToTop(x.getGameHelpId())}b=false;z.setReturnSceneUp(true)}}
;d.create=function(){C.styleCanvas();fn_setBackground(this,this.backgroundImgId);this.startBtn=this.add.text(400,300,q,{fontFamily:fn_getEnglishFont(),fontSize:100,color:p}).setInteractive().on(r,e).on(s,f).on(t,g);fn_centerTextXY(this.startBtn);this.helpBtn=this.add.text(400,300,u,{fontFamily:fn_getEnglishFont(),fontSize:85,color:p}).setInteractive().on(r,m).on(s,h).on(t,l);fn_centerText(this.helpBtn);this.helpBtn.y=this.startBtn.y+this.helpBtn.getBounds().height+50;this.add.text(0,0,v,{fontFamily:fn_getPinyinFont(),fontSize:10})};d.setGameTitleUp=function(a){b=a};d.update=function(){};return d}();var z=function(){var h='#FF00FF',l='#FFFF00',g='P',o='Return',n='Welcome to Word Hunter! Add instructions here...',m='assets/background.png',p='pointerdown',r='pointerout',q='pointerover';var b=false;function c(){var a=C.game.scene;if(b){console.log(g);a.moveAbove(x.getGameHelpId(),x.getGameTitleId());b=false;y.setGameTitleUp(true)}}
function d(){f.returnBtn.setStyle({fill:h})}
function e(){f.returnBtn.setStyle({fill:l})}
;var f=new Phaser.Scene(x.getGameHelpId());f.init=function(){this.backgroundImgId=fn_createId()};f.preload=function(){this.load.image(this.backgroundImgId,fn_getAssetPath()+m)};f.create=function(){C.styleCanvas();fn_setBackground(this,this.backgroundImgId);this.helpText=this.add.text(400,100,n,{fontFamily:fn_getEnglishFont(),fontSize:80,color:l});fn_centerText(this.helpText);this.returnBtn=this.add.text(0,0,o,{fontFamily:fn_getEnglishFont(),fontSize:90,color:l});fn_centerText(this.returnBtn);this.returnBtn.y=fn_getCanvasHeight()-this.returnBtn.getBounds().height*1.5;this.returnBtn.setInteractive().on(p,c).on(q,d).on(r,e)};f.update=function(){};f.setReturnSceneUp=function(a){b=a};return f}();var A=new Phaser.Scene(x.getGameSceneOneId());A.init=function(){this.musicId=fn_createId();this.pickUpAudioId=fn_createId();this.explosionAudioId=fn_createId();this.rockId=fn_createId();this.leftBtnId=fn_createId();this.rightBtnId=fn_createId();this.upBtnId=fn_createId();this.backgroundImgId=fn_createId();this.bombImgId=fn_createId();this.dudeImgId=fn_createId();this.platformImgId=fn_createId();this.brickImgId=fn_createId();this.spriteLeftId=fn_createId();this.spriteRightId=fn_createId();this.spriteTurnId=fn_createId();this.score=0;this.level=1;this.gameScene1Done=false;this.leftButtonDown=false;this.rightButtonDown=false;this.upButtonDown=false;this.currentMatchType=-1;this.showFrontSide=true;this.jumpable=false;this.frontList=[];this.backList=[];this.totalTime=300};A.preload=function(){var a='assets/asteroid.png',o='assets/background.png',r='assets/brick.png',p='assets/dude.png',c='assets/explosion.mp3',b='assets/explosion.ogg',l='assets/left.png',e='assets/pickup.mp3',d='assets/pickup.ogg',q='assets/platform.png',m='assets/right.png',h='assets/rock.png',g='assets/sci-fi.mp3',f='assets/sci-fi.ogg',n='assets/up.png';this.load.image(this.bombImgId,fn_getAssetPath()+a);this.load.audio(this.explosionAudioId,[fn_getAssetPath()+b,fn_getAssetPath()+c]);this.load.audio(this.pickUpAudioId,[fn_getAssetPath()+d,fn_getAssetPath()+e]);this.load.audio(this.musicId,[fn_getAssetPath()+f,fn_getAssetPath()+g]);this.load.image(this.rockId,fn_getAssetPath()+h);this.load.image(this.leftBtnId,fn_getAssetPath()+l);this.load.image(this.rightBtnId,fn_getAssetPath()+m);this.load.image(this.upBtnId,fn_getAssetPath()+n);this.load.image(this.backgroundImgId,fn_getAssetPath()+o);this.load.spritesheet(this.dudeImgId,fn_getAssetPath()+p,{frameWidth:32,frameHeight:48});this.load.image(this.platformImgId,fn_getAssetPath()+q);this.load.image(this.brickImgId,fn_getAssetPath()+r)};A.create=function(){var b=' ',d='#FFFFFF',c='bold',a='pointerup';fn_setToFullScreen(this);fn_setBackground(this,this.backgroundImgId);this.platforms=this.physics.add.staticGroup();this.platforms.create(fn_getCanvasWidth()/2,fn_getCanvasHeight()-100,this.brickImgId).setAlpha(0).setScale(2).refreshBody();this.platforms.create(fn_getCanvasWidth()-120,fn_getCanvasHeight()*0.25,this.platformImgId).setAlpha(0.4).setScale(2).refreshBody();this.platforms.create(180,fn_getCanvasHeight()*0.5,this.platformImgId).setAlpha(0.4).setScale(2).refreshBody();this.platforms.create(fn_getCanvasWidth()-320,fn_getCanvasHeight()*0.6,this.platformImgId).setAlpha(0.4).setScale(2).refreshBody();this.player=this.physics.add.sprite(100,450,this.dudeImgId);this.player.setInteractive({useHandCursor:true}).on(a,this.upDown);this.player.setCollideWorldBounds(true);this.player.scaleX=2;this.player.scaleY=2;this.player.setGravityY(2000);this.explosionSound=this.sound.add(this.explosionAudioId);this.pickupSound=this.sound.add(this.pickUpAudioId);this.music=fn_setUpAndPlayMusic(this,this.musicId);this.createPlayerAnimations();this.cursors=this.input.keyboard.createCursorKeys();this.spacebar=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);this.nextWord=this.add.text(0,0,b,{fontFamily:fn_getChineseFont(),fontWeight:c,fontSize:48*1.2,color:d});this.liveWords=[];this.bombs=this.physics.add.group();this.setUpGameStatusLabels();this.physics.add.collider(this.player,this.platforms,this.makeJumpable);this.physics.add.collider(this.bombs,this.platforms);this.physics.add.collider(this.player,this.bombs,this.hitBomb,null,this);C.styleCanvas();this.setUpPlayBtnsForMobile();fn_loadGameInfoByUUID();this.gameBatchTimer=this.time.addEvent({delay:1000,callback:this.updateTime,callbackScope:this,loop:true})};A.setUpGameStatusLabels=function(){var c='#FFFFFF',b='30px',a='Level: 1',f='List:',e='Score: 0',d='Time: ',g='Word Count: 1';this.levelText=this.add.text(16,16,a,{fontSize:b,fontFamily:fn_getChineseFont(),fill:c});this.timerText=this.add.text(16,56,d+this.totalTime,{fontSize:b,fontFamily:fn_getChineseFont(),fill:c});this.scoreText=this.add.text(16,96,e,{fontSize:b,fontFamily:fn_getChineseFont(),fill:c});this.titleText=this.add.text(this.sys.canvas.width,16,f,{fontSize:b,fontFamily:fn_getChineseFont(),fill:c});this.wordCountText=this.add.text(this.sys.canvas.width,56,g,{fontSize:b,fontFamily:fn_getChineseFont(),fill:c})}.bind(A);A.setUpPlayBtnsForMobile=function(){var g='#00FF00',d='pointerdown',f='pointerout',e='pointerup';if(fn_isMobile()){var a=this.add.image(32,568,this.leftBtnId);a.setInteractive().on(d,this.leftDown).on(e,this.leftUp).on(f,this.leftUp);a.x=150;a.y=fn_getCanvasHeight()-80;a.scaleX=2.5;a.scaleY=2.5;var b=this.add.image(160,568,this.rightBtnId);b.setInteractive().on(d,this.rightDown).on(e,this.rightUp).on(f,this.rightUp);b.x=450;b.y=a.y;b.scaleX=2.5;b.scaleY=2.5;b.setTint(g);var c=this.add.image(768,568,this.upBtnId);c.setInteractive().on(d,this.upDown);c.x=fn_getCanvasWidth()-150;c.y=a.y;c.scaleX=2.5;c.scaleY=2.5}}.bind(A);A.createPlayerAnimations=function(){this.anims.create({key:this.spriteLeftId,frames:this.anims.generateFrameNumbers(this.dudeImgId,{start:0,end:3}),frameRate:13,repeat:-1});this.anims.create({key:this.spriteTurnId,frames:[{key:this.dudeImgId,frame:4}],frameRate:20});this.anims.create({key:this.spriteRightId,frames:this.anims.generateFrameNumbers(this.dudeImgId,{start:5,end:8}),frameRate:13,repeat:-1})}.bind(A);A.getBombInitialX=function(){return this.player.x<fn_getCanvasWidth()/2?Phaser.Math.Between(fn_getCanvasWidth()/2,fn_getCanvasWidth()):Phaser.Math.Between(0,fn_getCanvasWidth()/2)}.bind(A);A.updateTime=function(){var a='Time: ';if(this.liveWords.length!=0&&this.totalTime>0){this.totalTime-=1}this.timerText.setText(a+this.totalTime)}.bind(A);A.addTimeToScore=function(){var h='Level: ',e='Score: ',d='Time: ',g='this.chineseArray.length: ',f='this.lastDataIndex: ';if(this.liveWords.length===0){if(this.totalTime>0){this.totalTime-=1;this.score+=1;this.timerText.setText(d+this.totalTime);this.scoreText.setText(e+this.score)}else{if(this.addTimeToScoreTimer){this.addTimeToScoreTimer.destroy()}if(this.level==100){this.gameScene1Done=true;this.explosionSound.play();A.player.anims.play(this.spriteTurnId);this.bombs.clear(true);this.music.stop();var a=this.time.delayedCall(1000,this.navigateToGameOverScene,[],this)}else{console.log(f+this.lastDataIndex);console.log(g+this.chineseArray.length);if(this.lastDataIndex<this.chineseArray.length-1){}else{this.level+=1;this.levelText.setText(h+this.level);this.lastDataIndex=-1}this.refreshWordPairs();this.totalTime=this.liveWords.length*30;if(this.totalTime<60){this.totalTime=60}if(this.gameBatchTimer){this.gameBatchTimer.paused=false}if(this.level>2){for(j=0;j<this.liveWords.length;j++){this.tweens.add({targets:this.liveWords[j],angle:Phaser.Math.Between(-20,20),duration:3000,yoyo:true,loop:-1})}}var b=Math.floor(this.level/2);for(i=0;i<b;i++){var c=this.bombs.create(this.getBombInitialX(),16,this.bombImgId);c.setBounce(1);c.setCollideWorldBounds(true);c.setVelocity(Phaser.Math.Between(-200,200),20);c.allowGravity=false}}}}}.bind(A);A.makeJumpable=function(){if(this.player.body.touching.down){this.jumpable=true}}.bind(A);A.leftDown=function(){this.leftButtonDown=true}.bind(A);A.leftUp=function(){this.leftButtonDown=false}.bind(A);A.rightDown=function(){this.rightButtonDown=true}.bind(A);A.rightUp=function(){this.rightButtonDown=false}.bind(A);A.setGameVocabLists=function(a,b,c,d,e){var g='Word Count: ',f='~';this.chineseArray=b.split(f);this.pinyinArray=c.split(f);this.englishArray=d.split(f);this.imgURLArray=e.split(f);this.lastDataIndex=-1;this.updateListName(a);this.wordCountText.setText(g+this.chineseArray.length);this.wordCountText.x=this.sys.canvas.width-this.wordCountText.getBounds().width-20;this.refreshWordPairs();this.totalTime=this.liveWords.length*30;if(this.totalTime<60){this.totalTime=60}}.bind(A);A.updateListName=function(a){this.titleText.setText(a);this.titleText.x=this.sys.canvas.width-this.titleText.getBounds().width-16}.bind(A);A.addToList=function(a,b){for(i=0;i<b.length;i++){a.push(b[i])}};A.refreshWordPairs=function(){this.frontList=[];this.backList=[];this.liveWords=[];var a=fn_getWordHunterMatchType();if(a==this.currentMatchType){a=fn_getWordHunterMatchType();this.currentMatchType=a}var b=12;if(this.chineseArray.length<b){b=this.chineseArray.length}var c=[];var d=[];var e=[];for(k=0;k<b;k++){this.lastDataIndex+=1;if(this.lastDataIndex<this.chineseArray.length){c.push(this.chineseArray[this.lastDataIndex]);d.push(this.pinyinArray[this.lastDataIndex]);e.push(this.englishArray[this.lastDataIndex])}}switch(a){case 0:A.addToList(this.frontList,c);A.addToList(this.backList,d);break;case 1:A.addToList(this.frontList,c);A.addToList(this.backList,e);break;case 2:A.addToList(this.frontList,d);A.addToList(this.backList,c);break;case 3:A.addToList(this.frontList,e);A.addToList(this.backList,c);break;}fn_createWordTextObjects(c,d,this.level,a,this.frontList,this.backList,this,this.liveWords);this.physics.add.collider(this.liveWords,this.platforms);this.physics.add.collider(this.liveWords,this.liveWords);this.physics.add.overlap(this.player,this.liveWords,this.collectWord,null,this);this.showPromptText()}.bind(A);A.showPromptText=function(){var d='';if(this.liveWords.length>0){this.toMatchIndex=Math.floor(Math.random()*this.liveWords.length);var a=this.liveWords[this.toMatchIndex].backText;var b=this.liveWords[this.toMatchIndex].chinese;var c=this.liveWords[this.toMatchIndex].pinyin;if(b.length<5){this.music.pause();fn_playWordSound(b,c);this.time.delayedCall(b.length*1000,function(){this.music.resume()},[],this)}this.nextWord.setText(a.text);this.nextWord.setFontFamily(a.style.fontFamily)}else{this.nextWord.setText(d)}fn_centerText(this.nextWord);this.nextWord.y=this.nextWord.getBounds().height}.bind(A);A.upDown=function(){if(this.player.body.touching.down){this.upButtonDown=true}}.bind(A);A.update=function(){if(this.gameScene1Done){return}if(this.cursors.left.isDown||this.leftButtonDown){this.player.setVelocityX(-400);this.player.anims.play(this.spriteLeftId,true)}else if(this.cursors.right.isDown||this.rightButtonDown){this.player.setVelocityX(400);this.player.anims.play(this.spriteRightId,true)}else{this.player.setVelocityX(0);this.player.anims.play(this.spriteTurnId)}if((this.cursors.up.isDown||this.upButtonDown)&&(this.player.body.touching.down&&this.jumpable)){this.jumpable=false;this.player.setVelocityY(-1600);this.upButtonDown=false}};A.collectWord=function(a,b){var e='',d='#0000FF',g='#00FF00',f='#FFFFFF',h='Score: ';if(this.nextWord.text.length<1){return}if(this.nextWord.text!=b.backText.text){if(this.level<=2){b.first.setColor(d)}return}b.backText.setVisible(true);b.add(b.backText);this.nextWord.setText(e);b.getAt(0).setColor(f);b.getAt(0).setOrigin(0.5);if(fn_hasChineseText(b.getAt(0).text)){b.getAt(0).setFontSize(48*2)}else{b.getAt(0).setFontSize(32*2)}b.getAt(1).setOrigin(0.5);b.getAt(1).setColor(f);if(fn_hasChineseText(b.getAt(1).text)){b.getAt(1).setFontSize(48*2)}else{b.getAt(1).setFontSize(32*2)}b.getAt(1).y=b.getAt(0).getBounds().height+10;b.body.setGravityY(10);b.body.allowGravity=true;if(this.level<3){this.tweens.add({targets:b,angle:Phaser.Math.Between(-120,120),duration:5000,yoyo:true,repeat:-1})}var c=this.liveWords.indexOf(b);if(c>=0){this.liveWords.splice(c,1)}this.time.delayedCall(1500,this.removeMatchedWord,[b],this);for(j=0;j<this.liveWords.length;j++){this.liveWords[j].first.setColor(g)}this.score+=10;this.scoreText.setText(h+this.score);this.pickupSound.play();if(this.liveWords.length===0){if(this.gameBatchTimer){this.gameBatchTimer.paused=true}this.bombs.clear(true);this.addTimeToScoreTimer=this.time.addEvent({delay:5,callback:this.addTimeToScore,callbackScope:this,loop:true})}}.bind(A);A.removeMatchedWord=function(a){a.removeAll(true);a.destroy();this.showPromptText()}.bind(A);A.hitBomb=function(a,b){this.gameScene1Done=true;this.explosionSound.play();a.setTint(16711680);a.anims.play(this.spriteTurnId);b.disableBody(true,true);a.disableBody(true,true);this.music.stop();fn_createAndExplodParticles(this,b.x,b.y,this.rockId);var c=this.time.delayedCall(1000,this.navigateToGameOverScene,[],this)}.bind(A);A.navigateToGameOverScene=function(){var a=C.game.scene;a.stop(x.getGameSceneOneId());a.start(x.getGameOverId());a.moveAbove(x.getGameSceneOneId(),x.getGameOverId())};var B=function(){var m='#000000',h='#FF00FF',l='#FFFF00',o='#FFFFFF',n='Game Over!',q='Play Again',p='Score: ',t='pointerout',s='pointerover',r='pointerup';function d(){C.game.scene.stop(x.getGameOverId());fn_startOver()}
function e(){g.tryAgainText.setStyle({fill:h})}
function f(){g.tryAgainText.setStyle({fill:l})}
;var g=new Phaser.Scene(x.getGameOverId());g.init=function(){this.backgroundImgId=fn_createId()};g.preload=function(){};g.create=function(){fn_setToFullScreen(this);C.styleCanvas();fn_createGradient(this,this.backgroundImgId,m,m);fn_setBackground(this,this.backgroundImgId);var a=50;var b=this.add.text(165,100,n,{fontFamily:fn_getEnglishFont(),fontSize:100,color:o});fn_centerTextXY(b);var c=this.add.text(280,225,p+A.score,{fontFamily:fn_getEnglishFont(),fontSize:70,color:o});fn_centerText(c);c.y=b.y+c.getBounds().height+a;this.tryAgainText=this.add.text(280,400,q,{fontFamily:fn_getEnglishFont(),fontSize:60,color:l}).setInteractive().on(r,d).on(s,e).on(t,f);fn_centerText(this.tryAgainText);this.tryAgainText.y=c.y+this.tryAgainText.getBounds().height+a};g.update=function(){};return g}();var C=function(){function b(){var a=fn_getConfig();a.scene.push(y);a.scene.push(z);a.scene.push(A);a.scene.push(B);return a}
w.setMainGameScene(A);var c={};c.game=new Phaser.Game(b());fn_registerDataAgent(w);c.styleCanvas=function(){fn_styleCanvas(this.game)};return c}();