var T=function(){var f;var g;var h={};h.runTimeCanvasWidth=function(){return f.sys.canvas.Width};h.runTimeCanvasHeight=function(){return f.sys.canvas.height};h.setMainGameScene=function(a){f=a};h.setGameOverScene=function(a){g=a};h.setGameVocabLists=function(a,b,c,d,e){f.setGameVocabLists(a,b,c,d,e)};h.setGameLeaderboard=function(a){g.setGameLeaderboard(a)};return h}();var U=function(){var k='0',l='1',i='gameGlass',h='gameHelp',f='gameOptions',d='gameOver',g='gameScene1',e='gameTitle',j='jigsaw_musicOn',m='jigsaw_puzzleBgOn',n='jigsawpuzzle';var c={};c.getGameOverId=function(){return d};c.getGameTitleId=function(){return e};c.getGameOptionsId=function(){return f};c.getGameSceneOneId=function(){return g};c.getGameHelpId=function(){return h};c.getGameGlassId=function(){return i};c.isMusicOn=function(){return fn_getLocal(j)!=k};c.setMusicOn=function(a){var b=a?l:k;fn_saveLocal(j,b)};c.isPuzzleBgOn=function(){return fn_getLocal(m)!=k};c.setPuzzleBgOn=function(a){var b=a?l:k;fn_saveLocal(m,b)};c.getAsset=function(a){return fn_getAsset(n,a)};return c}();U.gameTitle=function(){var l='Help',k='Options',j='Start',g='background.png',h='button-bg.png',i='pointerup';var c=fn_createScene(U.getGameTitleId());function d(){c.scene.start(U.getGameGlassId());c.scene.sleep(U.getGameGlassId());c.scene.start(U.getGameSceneOneId());c.scene.moveAbove(U.getGameTitleId(),U.getGameSceneOneId());c.scene.moveAbove(U.getGameGlassId(),U.getGameSceneOneId())}
function e(){c.scene.start(U.getGameOptionsId());c.scene.stop(U.getGameTitleId())}
function f(){c.scene.start(U.getGameHelpId());c.scene.stop(U.getGameTitleId())}
c.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId()};c.preload=function(){var a=U.getAsset(g);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b);this.userBackgroundImageUsed=true}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,U.getAsset(h))};c.create=function(){U.gameMaster.styleCanvas();if(this.userBackgroundImageUsed){fn_setBackground(this,this.backgroundImgId)}else{fn_createTileSprite(this,this.backgroundImgId)}this.startBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.15).setInteractive({useHandCursor:true}).on(i,d);fn_centerObject(this,this.startBtnBg,1.5);fn_nestedInCenter(fn_createTitlePageBtn(this,j,d),this.startBtnBg);this.optionsBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.15).setInteractive({useHandCursor:true}).on(i,e);fn_centerObject(this,this.optionsBtnBg,0);fn_nestedInCenter(fn_createTitlePageBtn(this,k,e),this.optionsBtnBg);this.helpBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.15).setInteractive({useHandCursor:true}).on(i,f);fn_centerObject(this,this.helpBtnBg,-1.5);fn_nestedInCenter(fn_createTitlePageBtn(this,l,f),this.helpBtnBg);fn_initPinyinFont(this)};c.update=function(){};return c}();U.gameHelp=function(){var i='#000000',l='Return',h='Welcome to Jigsaw Puzzle!\n\nClick to rotate the pieces and drag them into place. How fast can you solve the puzzles? Have fun!',e='background.png',f='button-bg.png',j='center',g='frame.png',k='pointerup';function c(){d.scene.stop(U.getGameHelpId());d.scene.start(U.getGameTitleId())}
var d=fn_createScene(U.getGameHelpId());d.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId();this.frameImgId=fn_createId()};d.preload=function(){var a=U.getAsset(e);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b);this.userBackgroundImageUsed=true}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,U.getAsset(f));this.load.image(this.frameImgId,U.getAsset(g))};d.create=function(){U.gameMaster.styleCanvas();if(this.userBackgroundImageUsed){fn_setBackground(this,this.backgroundImgId)}else{fn_createTileSprite(this,this.backgroundImgId)}this.helpTextBg=this.add.sprite(100,200,this.frameImgId).setScale(1.25);fn_centerObject(this,this.helpTextBg,1.5);var a=h;this.helpText=this.add.text(400,100,a,{fontFamily:fn_getEnglishFont(),fontSize:36,color:i,align:j,wordWrap:{width:700,useAdvancedWrap:true}});fn_nestedInCenter(this.helpText,this.helpTextBg);this.returnBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.25).setInteractive({useHandCursor:true}).on(k,c);fn_centerObject(this,this.returnBtnBg,-4);fn_nestedInCenter(fn_createTitlePageBtn(this,l,c),this.returnBtnBg)};d.update=function(){};return d}();U.gameOptions=function(){var m='#000000',j='Enable puzzle background',i='Enable sound',l='Return',e='background.png',f='button-bg.png',g='checkedCheckbox.png',n='left',k='pointerup',h='uncheckedCheckbox.png';function c(){d.scene.stop(U.getGameOptionsId());d.scene.start(U.getGameTitleId())}
var d=fn_createScene(U.getGameOptionsId());d.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId();this.checkedCheckboxId=fn_createId();this.uncheckedCheckboxId=fn_createId();this.musicOn=U.isMusicOn();this.puzzleBgOn=U.isPuzzleBgOn()};d.preload=function(){var a=U.getAsset(e);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b);this.userBackgroundImageUsed=true}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.btnBackgroundImgId,U.getAsset(f));this.load.image(this.checkedCheckboxId,U.getAsset(g));this.load.image(this.uncheckedCheckboxId,U.getAsset(h))};d.create=function(){U.gameMaster.styleCanvas();if(this.userBackgroundImageUsed){fn_setBackground(this,this.backgroundImgId)}else{fn_createTileSprite(this,this.backgroundImgId)}this.musicButton=this.add.image(0,0,this.checkedCheckboxId);this.musicButtonText=this.createLabel(i);fn_centerObject(this,this.musicButton,0.5);this.musicButton.x=this.musicButton.x-(this.musicButton.getBounds().width+this.musicButtonText.getBounds().width)/2;this.musicButtonText.y=this.musicButton.y-this.musicButton.getBounds().height/2;this.musicButtonText.x=this.musicButton.x+this.musicButton.getBounds().width+3;this.puzzleBgButton=this.add.image(0,0,this.checkedCheckboxId);this.puzzleBgButtonText=this.createLabel(j);fn_centerObject(this,this.puzzleBgButton,-0.5);this.puzzleBgButton.x=this.musicButton.x;this.puzzleBgButtonText.y=this.puzzleBgButton.y-this.puzzleBgButton.getBounds().height/2;this.puzzleBgButtonText.x=this.puzzleBgButton.x+this.puzzleBgButton.getBounds().width+3;this.musicButton.setInteractive({useHandCursor:true}).on(k,function(){this.musicOn=!this.musicOn;this.updateOptions()},this);this.puzzleBgButton.setInteractive({useHandCursor:true}).on(k,function(){this.puzzleBgOn=!this.puzzleBgOn;this.updateOptions()},this);this.updateOptions();this.returnBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(1.15).setInteractive({useHandCursor:true}).on(k,c);fn_centerObject(this,this.returnBtnBg,-4);fn_nestedInCenter(fn_createTitlePageBtn(this,l,c),this.returnBtnBg)};d.createLabel=function(a){return this.add.text(0,0,a,{fontFamily:fn_getEnglishFont(),fontSize:32,color:m,align:n})}.bind(d);d.updateOptions=function(){if(this.musicOn){this.musicButton.setTexture(this.checkedCheckboxId)}else{this.musicButton.setTexture(this.uncheckedCheckboxId)}U.setMusicOn(this.musicOn);this.musicButton.scale=1.8;if(this.puzzleBgOn){this.puzzleBgButton.setTexture(this.checkedCheckboxId)}else{this.puzzleBgButton.setTexture(this.uncheckedCheckboxId)}U.setPuzzleBgOn(this.puzzleBgOn);this.puzzleBgButton.scale=1.8}.bind(d);d.update=function(){};return d}();U.gameGlass=function(){var d='Resume',e='Stop',b='button-bg.png',c='pointerup';var a=fn_createScene(U.getGameGlassId());a.init=function(){this.btnBackgroundImgId=fn_createId()};a.preload=function(){this.load.image(this.btnBackgroundImgId,U.getAsset(b))};a.create=function(){this.resumeBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(c,this.resumeGame);this.resumeBtnBg.alpha=0.5;fn_centerObject(this,this.resumeBtnBg,-5);this.resumeBtnBg.x=this.sys.canvas.width-2*this.resumeBtnBg.getBounds().width-20+70;this.resumeBtn=fn_createBtn(this,d,24,this.resumeGame);this.resumeBtn.alpha=0.7;fn_nestedInCenter(this.resumeBtn,this.resumeBtnBg);this.stopBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(c,this.stopGame);this.stopBtnBg.alpha=0.5;fn_centerObject(this,this.stopBtnBg,-5);this.stopBtnBg.x=this.sys.canvas.width-this.stopBtnBg.getBounds().width-10+70;this.stopBtn=fn_createBtn(this,e,24,this.stopGame);this.stopBtn.alpha=0.7;fn_nestedInCenter(this.stopBtn,this.stopBtnBg)};a.resumeGame=function(){a.scene.sleep(U.getGameGlassId());a.scene.resume(U.getGameSceneOneId());a.scene.get(U.getGameSceneOneId()).enablePauseBtn()}.bind(a);a.stopGame=function(){a.scene.stop(U.getGameSceneOneId());a.scene.stop(U.getGameGlassId());a.scene.start(U.getGameOverId())}.bind(a);a.update=function(){};return a}();U.gameScene1=function(){var q='',G='#CCCCCC',L='#ffffff',Q='0xFF0000',F='480',N=':',z='Created By: ',B='Pause',C='Stop',M='Time: ',x='Time: 0',E='Word Count: ',y='Word Count: 0',r='background.png',s='button-bg.png',H='center',t='checkmark.png',w='cheer.mp3',P='drag',R='dragend',O='dragstart',I='filecomplete',u='flower.png',v='pickup.mp3',S='pointerdown',K='pointerout',J='pointerover',A='pointerup',D='~';var p=fn_createScene(U.getGameSceneOneId());p.init=function(){this.backgroundImgId=fn_createId();this.defaultBackgroundImgId=fn_createId();this.defaultPuzzleImgId=fn_createId();this.btnBackgroundImgId=fn_createId();this.pickupAudioId=fn_createId();this.cheerAudioId=fn_createId();this.checkMarkId=fn_createId();this.doneTileCount=0;this.totalTileCount=0;this.tilesLastRound=[];this.isSoundOn=U.isMusicOn();this.isPuzzleBackgroundOn=U.isPuzzleBgOn();this.clickDowntime=0;this.totalTime=0;this.tilesReadyHandled=true;this.currentWord=q;this.currentPinyin=q;this.currentEnglish=q;this.currentImgURL=q;this.characterIndex=0};p.preload=function(){var a=U.getAsset(r);var b=fn_getUserBackgroundImageURL();if(b.length>0){this.load.image(this.backgroundImgId,b);this.userBackgroundImageUsed=true}else{this.load.image(this.backgroundImgId,a)}this.load.image(this.defaultBackgroundImgId,a);this.load.image(this.btnBackgroundImgId,this.getAsset(s));this.load.image(this.checkMarkId,this.getAsset(t));this.load.image(this.defaultPuzzleImgId,this.getAsset(u));if(this.isSoundOn){this.loadMusic(this.pickupAudioId,v);this.loadMusic(this.cheerAudioId,w)}};p.create=function(){fn_createTileSprite(this,this.defaultBackgroundImgId);if(this.isSoundOn){this.pickupSound=this.sound.add(this.pickupAudioId);this.cheerSound=this.sound.add(this.cheerAudioId)}this.setUpGameStatusLabels();fn_loadGameVocabListsByUUID()};p.update=function(){};p.getAsset=function(a){return U.getAsset(a)};p.loadMusic=function(a,b){this.load.audio(a,[this.getAsset(b)])}.bind(p);p.setUpGameStatusLabels=function(){this.timerText=fn_createStatusLabel(this,16,16,x);fn_createProgressBar(this,16,56,160,30);fn_updateProgressBar(this,0);this.titleText=fn_createStatusLabel(this,this.sys.canvas.width,16,q);this.wordCountText=fn_createStatusLabel(this,this.sys.canvas.width,56,y);this.creatorText=fn_createStatusLabel(this,this.sys.canvas.width,96,z);this.pauseBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(A,this.pauseGame);this.pauseBtnBg.alpha=0.5;fn_centerObject(this,this.pauseBtnBg,-5);this.pauseBtnBg.x=this.sys.canvas.width-2*this.pauseBtnBg.getBounds().width-20+70;this.pauseBtn=fn_createBtn(this,B,24,this.pauseGame);this.pauseBtn.alpha=0.7;fn_nestedInCenter(this.pauseBtn,this.pauseBtnBg);this.stopBtnBg=this.add.sprite(100,200,this.btnBackgroundImgId).setScale(0.5).setInteractive({useHandCursor:true}).on(A,this.navigateToGameOverScene);this.stopBtnBg.alpha=0.5;fn_centerObject(this,this.stopBtnBg,-5);this.stopBtnBg.x=this.sys.canvas.width-this.stopBtnBg.getBounds().width-10+70;this.stopBtn=fn_createBtn(this,C,24,this.navigateToGameOverScene);this.stopBtn.alpha=0.7;fn_nestedInCenter(this.stopBtn,this.stopBtnBg)}.bind(p);p.pauseGame=function(){p.scene.pause(U.getGameSceneOneId());p.scene.wake(U.getGameGlassId());p.scene.moveAbove(U.getGameSceneOneId(),U.getGameGlassId())}.bind(p);p.enablePauseBtn=function(){p.pauseBtn.setText(B);fn_nestedInCenter(p.pauseBtn,p.pauseBtnBg)};p.setGameVocabLists=function(a,b,c,d,e){this.chineseArray=b.split(D);this.pinyinArray=c.split(D);this.englishArray=d.split(D);this.imgURLArray=e.split(D);this.updateListName(a);this.totalTileCount=this.calcTotalTileCount();this.wordCountText.setText(E+this.chineseArray.length);this.wordCountText.x=this.sys.canvas.width-this.wordCountText.getBounds().width-20;this.shuffleChinesePinyinEnglishImgArrays();if(this.gameTimer){this.gameTimer.paused=true}this.currentWord=this.chineseArray.shift();this.currentPinyin=this.pinyinArray.shift();this.currentEnglish=this.englishArray.shift();this.currentImgURL=fn_getSecImgURL(this.imgURLArray.shift(),F);this.characterIndex=0;this.setAndPlayPuzzle()}.bind(p);p.calcTotalTileCount=function(){var a=0;var b=this.getSquareCount();var c=b*b;for(var d=0;d<this.chineseArray.length;d++){a+=c*this.chineseArray[d].length}return a}.bind(p);p.shuffleChinesePinyinEnglishImgArrays=function(){var a=fn_syncShuffle([this.chineseArray,this.pinyinArray,this.englishArray,this.imgURLArray]);this.chineseArray=a[0];this.pinyinArray=a[1];this.englishArray=a[2];this.imgURLArray=a[3]}.bind(p);p.setAndPlayPuzzle=function(){var a=fn_getCanvasWidth();var b=fn_getCanvasHeight();var c=a>b?b:a;var d=c*0.01;var e=c*0.01;this.puzzleSize=c-d-e;var f=this.getSquareCount();var g=f;this.tileWidth=Math.floor(this.puzzleSize/f);this.tileHeight=Math.floor(this.puzzleSize/g);var h=(fn_getCanvasWidth()-this.puzzleSize)/2;var i=(fn_getCanvasHeight()-this.puzzleSize)/2;if(!!!this.graphics){this.graphics=this.add.graphics(0,0)}this.graphics.clear();this.graphics.fillStyle=G;this.graphics.fillRect(h,i,this.puzzleSize,this.puzzleSize);fn_destroy(this.chineseText);this.chineseText=this.add.text(fn_getCanvasWidth()/2,fn_getCanvasHeight()/2,q+this.currentWord.charAt(this.characterIndex),{fontFamily:fn_getChineseFont(),fontSize:480,color:fn_getGameTextColor(),align:H}).setOrigin(0.5);this.chineseText.scale=0.95*this.puzzleSize/this.chineseText.getBounds().width;if(this.isPuzzleBackgroundOn){if(this.currentImgURL!=null&&this.currentImgURL.length>10){this.load.on(I,this.handleCharImgLoaded,this);this.load.image(fn_createId(),this.currentImgURL);this.load.start()}else{var j=this.defaultPuzzleImgId;if(this.userBackgroundImageUsed){j=this.backgroundImgId}if(this.puzzleBgImg){this.children.bringToTop(this.puzzleBgImg);this.puzzleBgImg.alpha=0.4}else{this.puzzleBgImg=this.add.image(fn_getCanvasWidth()/2,fn_getCanvasHeight()/2,j);this.puzzleBgImg.setAlpha(0.4);this.puzzleBgImg.setDisplaySize(this.puzzleSize,this.puzzleSize)}this.handleCharacterBackgroundImageReady(j)}}else{this.handleCharacterBackgroundImageReady(null)}}.bind(p);p.handleCharImgLoaded=function(a,b,c){fn_destroy(this.puzzleBgImg);this.puzzleBgImg=this.add.image(fn_getCanvasWidth()/2,fn_getCanvasHeight()/2,a);this.puzzleBgImg.setAlpha(0.4);this.puzzleBgImg.setDisplaySize(this.puzzleSize,this.puzzleSize);this.handleCharacterBackgroundImageReady(a)}.bind(p);p.handleCharacterBackgroundImageReady=function(c){var d=this.getSquareCount();var e=d;var f=(fn_getCanvasWidth()-this.puzzleSize)/2;var g=(fn_getCanvasHeight()-this.puzzleSize)/2;this.puzzlePieces=[];this.tileLocations=[];for(var h=0;h<e;h++){for(var i=0;i<d;i++){var j=f+i*this.tileWidth;var k=g+h*this.tileHeight;var l=fn_point(j,k);this.tileLocations.push(l)}}var m=(fn_getCanvasWidth()-this.puzzleSize)/2;this.graphics.fillStyle=G;this.graphics.fillRect(0,fn_getCanvasHeight()/2-m/2,m,m);if(this.isPuzzleBackgroundOn){fn_destroy(this.previewImg);this.previewImg=this.add.image(m/2,fn_getCanvasHeight()/2,c);this.previewImg.setAlpha(0.4);this.previewImg.setDisplaySize(m,m)}if(this.previewChineseText){this.children.bringToTop(this.previewChineseText);this.previewChineseText.text=this.currentWord.charAt(this.characterIndex)}else{this.previewChineseText=this.add.text(m/2,fn_getCanvasHeight()/2,q+this.currentWord.charAt(this.characterIndex),{fontFamily:fn_getChineseFont(),fontSize:980*m/this.puzzleSize,color:fn_getGameTextColor,align:H}).setOrigin(0.5)}if(!!!this.previewPinyinText){var n=fn_processPinyin(fn_getCharPinyin(this.currentPinyin,this.characterIndex));this.previewPinyinText=this.add.text(m/2,fn_getCanvasHeight()/2-m*0.6,n,{fontFamily:fn_getPinyinFont(),fontSize:68,color:fn_getGameTextColor(),align:H}).setOrigin(0.5);this.previewPinyinText.setInteractive({useHandCursor:true}).on(A,function(){if(this.isSoundOn){var a=this.currentWord.charAt(this.characterIndex);var b=fn_getCharPinyin(this.currentPinyin,this.characterIndex);fn_playWordSound(a,b)}},this).on(J,function(){this.previewPinyinText.setStyle({fill:fn_getGameVisitedTextColor()})},this).on(K,function(){this.previewPinyinText.setStyle({fill:fn_getGameTextColor()})},this);var o=fn_processPinyin(this.currentPinyin);this.wordPinyinText=this.add.text(m/2,fn_getCanvasHeight()/2+m*0.7,o,{fontFamily:fn_getPinyinFont(),fontSize:48,color:fn_getGameVisitedTextColor(),align:H,wordWrap:{width:m,useAdvancedWrap:true}}).setOrigin(0.5);this.wordPinyinText.setInteractive({useHandCursor:true}).on(A,function(){if(this.isSoundOn){var a=this.currentWord;var b=this.currentPinyin;fn_playWordSound(a,b)}},this).on(J,function(){this.wordPinyinText.setStyle({fill:fn_getGameTextColor()})},this).on(K,function(){this.wordPinyinText.setStyle({fill:fn_getGameVisitedTextColor()})},this);this.wordChineseText=this.add.text(m/2,fn_getCanvasHeight()/2+m*0.9,this.currentWord,{fontFamily:fn_getChineseFont(),fontSize:78,color:fn_getGameVisitedTextColor(),align:H,wordWrap:{width:m,useAdvancedWrap:true}}).setOrigin(0.5);this.wordEnglishText=this.add.text(m/2,fn_getCanvasHeight()/2+m*1.05,this.currentEnglish,{fontFamily:fn_getEnglishFont(),fontSize:32,color:fn_getGameVisitedTextColor(),align:H,wordWrap:{width:m,useAdvancedWrap:true}}).setOrigin(0.5)}this.children.bringToTop(this.chineseText);this.tilesReadyHandled=false;this.createTiles()}.bind(p);p.handleTilesReady=function(){if(this.tilesReadyHandled){return}this.tilesReadyHandled=true;var a=this.getSquareCount();var b=a;var c=(fn_getCanvasWidth()-this.puzzleSize)/2;var d=(fn_getCanvasHeight()-this.puzzleSize)/2;this.graphics=this.add.graphics(0,0);this.graphics.strokeStyle=L;for(var e=0;e<b;e++){for(var f=0;f<a;f++){var g=f*this.tileWidth;var h=e*this.tileHeight;this.graphics.strokeRect(c+g,d+h,this.tileWidth,this.tileHeight)}}fn_phaseOut(this,this.chineseText,7000);if(this.isPuzzleBackgroundOn){fn_phaseOut(this,this.puzzleBgImg,7000)}var i=this.puzzlePieces.length;var j=this.tileWidth/8;var k=(fn_getCanvasWidth()-this.puzzleSize)/2;for(var e=0;e<i;e++){var l=this.puzzlePieces[e];l.x=l.location.x+this.tileWidth;l.y=l.location.y+this.tileHeight;this.setPieceInteractive(l);l.setVisible(true);var m=fn_rand(0,360);var g=this.puzzleSize+k+k/2+fn_rand(-20,20);var h=200+this.tileWidth/2+j*e;fn_easeRotate(this,l,g,h,m,3000);l.setTint(Math.random()*16777215,Math.random()*16777215,Math.random()*16777215,Math.random()*16777215);this.children.bringToTop(this.puzzlePieces[fn_rand(0,i-1)])}p.time.delayedCall(1000,fn_setToFullScreen,[this],this)}.bind(p);p.createTiles=function(){if(this.tileLocations.length>0){var d=this.tileLocations.shift();var e=this.textures;U.gameMaster.game.renderer.snapshotArea(d.x,d.y,this.tileWidth,this.tileHeight,function(a){var b=fn_createId();e.addImage(b,a);var c=p.add.image(0,0,b);c.setVisible(false);c.location=d;p.tilesLastRound.push(c);p.puzzlePieces.push(c);p.time.delayedCall(50,p.createTiles,[],p)})}else{this.handleTilesReady()}}.bind(p);p.getSquareCount=function(){var a=parseInt(fn_getDifficultyLevel());switch(a){case 0:return 2;case 1:return 3;case 2:return 4;}};p.checkCorrect=function(a){var b=(fn_getCanvasWidth()-this.puzzleSize)/2;var c=(fn_getCanvasHeight()-this.puzzleSize)/2;var d=(fn_getCanvasWidth()-this.puzzleSize)/2;var e=true;if(a.angle){e=a.angle%360==0}var f=a.location.x+this.tileWidth/2;var g=a.location.y+this.tileHeight/2;var h=Math.abs(a.x-f)<this.tileWidth/4&&Math.abs(a.y-g)<this.tileHeight/4;if(e&&h){a.removeInteractive();fn_easeMove(this,a,f,g,function(){});fn_removeElement(this.puzzlePieces,a);this.doneTileCount+=1;this.updateProgress();if(this.puzzlePieces.length==0){if(this.isSoundOn){fn_playSound(this.cheerSound,fn_getBackgroundMusicVolume(),false)}this.gameTimer.paused=true;if(this.greenCheckMark){this.greenCheckMark.setVisible(true)}else{this.greenCheckMark=this.add.image(0,0,this.checkMarkId);this.greenCheckMark.scale=2;fn_centerObject(this,this.greenCheckMark,0);this.greenCheckMark.x=this.puzzleSize+d+d/2}this.time.delayedCall(2000,this.refreshBoardWithNewChinese,[],this)}else{if(this.isSoundOn){fn_playSound(this.pickupSound,fn_getBackgroundMusicVolume(),false)}}}}.bind(p);p.refreshBoardWithNewChinese=function(){if(this.characterIndex==this.currentWord.length-1){if(this.chineseArray.length==0){this.navigateToGameOverScene();return}else{this.currentWord=this.chineseArray.shift();this.currentPinyin=this.pinyinArray.shift();this.currentEnglish=this.englishArray.shift();this.currentImgURL=fn_getSecImgURL(this.imgURLArray.shift(),F);this.characterIndex=0}}else{this.characterIndex+=1}for(var a=0;a<this.tilesLastRound.length;a++){this.tilesLastRound[a].destroy()}this.greenCheckMark.setVisible(false);var b=q+this.currentWord.charAt(this.characterIndex);this.previewPinyinText.text=fn_processPinyin(fn_getCharPinyin(this.currentPinyin,this.characterIndex));this.wordPinyinText.text=fn_processPinyin(this.currentPinyin);this.wordChineseText.text=this.currentWord;this.wordEnglishText.text=this.currentEnglish;this.setAndPlayPuzzle()}.bind(p);p.updateTime=function(){this.totalTime+=1;this.timerText.setText(M+fn_formatSeconds(Math.floor(this.totalTime/10))+N+this.totalTime%10)}.bind(p);p.updateListName=function(a){this.titleText.setText(a);this.titleText.x=this.sys.canvas.width-this.titleText.getBounds().width-16;this.creatorText.setText(z+fn_getCreator());this.creatorText.x=this.sys.canvas.width-this.creatorText.getBounds().width-16}.bind(p);p.updateProgress=function(){if(this.totalTileCount>0){var a=this.doneTileCount/this.totalTileCount;fn_updateProgressBar(this,a)}}.bind(p);p.setPieceInteractive=function(d){d.setInteractive({useHandCursor:true,draggable:true}).on(O,function(a,b,c){d.alpha=0.8;this.children.bringToTop(d);if(!!!this.gameTimer){this.gameTimer=this.time.addEvent({delay:100,callback:this.updateTime,callbackScope:this,loop:true})}else{this.gameTimer.paused=false}},this).on(P,function(a,b,c){d.setTint(Q);d.setPosition(b,c)}).on(R,function(a,b,c){d.clearTint();d.alpha=1;this.checkCorrect(d)},this).on(S,function(){d.clearTint();d.alpha=1;this.clickDowntime=(new Date).getTime()},this).on(A,function(){d.clearTint();d.alpha=1;if((new Date).getTime()-this.clickDowntime<350){d.angle=90+Math.ceil(d.angle/90)*90}else{}},this).on(J,function(){d.alpha=0.8},this).on(K,function(){d.alpha=1},this)}.bind(p);p.navigateToGameOverScene=function(){if(this.doneTileCount<this.totalTileCount){this.totalTime=0}p.scene.stop(U.getGameSceneOneId());p.scene.stop(U.getGameGlassId());p.scene.start(U.getGameOverId())}.bind(p);return p}();U.gameOver=function(){var d='#000000',c='button-bg.png';var b=fn_createScene(U.getGameOverId());b.init=function(){this.backgroundImgId=fn_createId();this.btnBackgroundImgId=fn_createId()};b.preload=function(){this.load.image(this.btnBackgroundImgId,U.getAsset(c))};b.create=function(){fn_stopFullScreen(this);fn_createGradient(this,this.backgroundImgId,d,d);fn_setBackground(this,this.backgroundImgId);fn_centerObject(this,fn_createGameOverLabel(this),3);var a=U.gameScene1.totalTime;if(a>0){this.finalTime=fn_formatMilliSeconds(U.gameScene1.totalTime);fn_centerObject(this,fn_createFinalTimeLabel(this,this.finalTime),2)}fn_createPlayAgainBtn(this,this.btnBackgroundImgId);if(fn_isInternetExplorer()){}else{fn_loadGameLeaderboard()}};b.update=function(){};b.setGameLeaderboard=function(a){fn_showTimeLeaderboard(this,a,U.gameScene1.totalTime,document)}.bind(b);return b}();U.gameMaster=function(){function b(){var a=fn_getConfig();a.scene.push(U.gameTitle);a.scene.push(U.gameHelp);a.scene.push(U.gameOptions);a.scene.push(U.gameGlass);a.scene.push(U.gameScene1);a.scene.push(U.gameOver);a.physics.arcade.gravity.y=0;a.type=fn_getTypeCanvas();return a}
T.setMainGameScene(U.gameScene1);T.setGameOverScene(U.gameOver);var c={};c.game=fn_createGame(b());fn_registerDataAgent(T);c.styleCanvas=function(){fn_styleCanvas(this.game)};return c}();